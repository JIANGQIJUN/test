`timescale 1ns / 1ps
module filter1#(parameter INPUT_WIDTH=15,FILTER_WIDTH=10,LENGTH=9,L=4,TAP=8,PATH=24
 )(
 input[INPUT_WIDTH:0]x,
input [10:0]h0_0_0,
 input [10:0]h0_0_1,
 input [10:0]h0_0_2,
 input [10:0]h0_0_3,
 input [10:0]h0_0_4,
 input [10:0]h0_0_5,
 input [10:0]h0_0_6,
 input [10:0]h0_0_7,
 input [10:0]h0_0_8,
 input [10:0]h0_0_9,
 input [10:0]h0_0_10,
 input [10:0]h0_0_11,
 input [10:0]h0_0_12,
 input [10:0]h0_0_13,
 input [10:0]h0_0_14,
 input [10:0]h0_0_15,
 input [10:0]h0_1_0,
 input [10:0]h0_1_1,
 input [10:0]h0_1_2,
 input [10:0]h0_1_3,
 input [10:0]h0_1_4,
 input [10:0]h0_1_5,
 input [10:0]h0_1_6,
 input [10:0]h0_1_7,
 input [10:0]h0_1_8,
 input [10:0]h0_1_9,
 input [10:0]h0_1_10,
 input [10:0]h0_1_11,
 input [10:0]h0_1_12,
 input [10:0]h0_1_13,
 input [10:0]h0_1_14,
 input [10:0]h0_1_15,
 input [10:0]h1_0_0,
 input [10:0]h1_0_1,
 input [10:0]h1_0_2,
 input [10:0]h1_0_3,
 input [10:0]h1_0_4,
 input [10:0]h1_0_5,
 input [10:0]h1_0_6,
 input [10:0]h1_0_7,
 input [10:0]h1_0_8,
 input [10:0]h1_0_9,
 input [10:0]h1_0_10,
 input [10:0]h1_0_11,
 input [10:0]h1_0_12,
 input [10:0]h1_0_13,
 input [10:0]h1_0_14,
 input [10:0]h1_0_15,
 input [10:0]h1_1_0,
 input [10:0]h1_1_1,
 input [10:0]h1_1_2,
 input [10:0]h1_1_3,
 input [10:0]h1_1_4,
 input [10:0]h1_1_5,
 input [10:0]h1_1_6,
 input [10:0]h1_1_7,
 input [10:0]h1_1_8,
 input [10:0]h1_1_9,
 input [10:0]h1_1_10,
 input [10:0]h1_1_11,
 input [10:0]h1_1_12,
 input [10:0]h1_1_13,
 input [10:0]h1_1_14,
 input [10:0]h1_1_15,
 input [10:0]h2_0_0,
 input [10:0]h2_0_1,
 input [10:0]h2_0_2,
 input [10:0]h2_0_3,
 input [10:0]h2_0_4,
 input [10:0]h2_0_5,
 input [10:0]h2_0_6,
 input [10:0]h2_0_7,
 input [10:0]h2_0_8,
 input [10:0]h2_0_9,
 input [10:0]h2_0_10,
 input [10:0]h2_0_11,
 input [10:0]h2_0_12,
 input [10:0]h2_0_13,
 input [10:0]h2_0_14,
 input [10:0]h2_0_15,
 input [10:0]h2_1_0,
 input [10:0]h2_1_1,
 input [10:0]h2_1_2,
 input [10:0]h2_1_3,
 input [10:0]h2_1_4,
 input [10:0]h2_1_5,
 input [10:0]h2_1_6,
 input [10:0]h2_1_7,
 input [10:0]h2_1_8,
 input [10:0]h2_1_9,
 input [10:0]h2_1_10,
 input [10:0]h2_1_11,
 input [10:0]h2_1_12,
 input [10:0]h2_1_13,
 input [10:0]h2_1_14,
 input [10:0]h2_1_15,
 input [10:0]h3_0_0,
 input [10:0]h3_0_1,
 input [10:0]h3_0_2,
 input [10:0]h3_0_3,
 input [10:0]h3_0_4,
 input [10:0]h3_0_5,
 input [10:0]h3_0_6,
 input [10:0]h3_0_7,
 input [10:0]h3_0_8,
 input [10:0]h3_0_9,
 input [10:0]h3_0_10,
 input [10:0]h3_0_11,
 input [10:0]h3_0_12,
 input [10:0]h3_0_13,
 input [10:0]h3_0_14,
 input [10:0]h3_0_15,
 input [10:0]h3_1_0,
 input [10:0]h3_1_1,
 input [10:0]h3_1_2,
 input [10:0]h3_1_3,
 input [10:0]h3_1_4,
 input [10:0]h3_1_5,
 input [10:0]h3_1_6,
 input [10:0]h3_1_7,
 input [10:0]h3_1_8,
 input [10:0]h3_1_9,
 input [10:0]h3_1_10,
 input [10:0]h3_1_11,
 input [10:0]h3_1_12,
 input [10:0]h3_1_13,
 input [10:0]h3_1_14,
 input [10:0]h3_1_15,
 input clk1,
 input clk2,
 input clk3,
 input clk4,
 input clk5,
 input clk6,
 input clk7,
 input clk8,
 input clk9,
 input clk,
 input rst,
 input [3:0]l,
 input en,
 output signed [INPUT_WIDTH:0]y11
 );
 integer i,j,k,m,n,p,q;
 genvar I,J,K,N;
 localparam SUM_WIDTH=INPUT_WIDTH+FILTER_WIDTH+1;
 reg signed[FILTER_WIDTH+1:0]out[LENGTH-1:0][L-1:0][INPUT_WIDTH:0];//滤波器每一项输出
 reg signed[FILTER_WIDTH:0]out1[LENGTH-1:0][L-1:0][INPUT_WIDTH:0];//滤波器每一项输出
 reg signed[FILTER_WIDTH:0]out2[LENGTH-1:0][L-1:0][INPUT_WIDTH:0];//滤波器每一项输出
 reg signed[SUM_WIDTH:0]sum1[LENGTH-1:0][L-1:0];//子滤波器输出
 reg signed[SUM_WIDTH:0]sum[LENGTH-1:0][L-1:0][INPUT_WIDTH:0];//子滤波器输出
 reg signed[SUM_WIDTH:0]sum2[LENGTH-1:0];//单个滤波器输出
 reg signed[INPUT_WIDTH:0]delay1[LENGTH-1:0][TAP-1:0];//子滤波器内部寄存器
 reg [TAP/2-1:0]addra1[LENGTH-1:0][INPUT_WIDTH:0];//查找表地址
 reg [TAP/2-1:0]addra2[LENGTH-1:0][INPUT_WIDTH:0];//查找表地址
 reg signed[INPUT_WIDTH:0]y1;
 reg [1:0]cnt99;
 reg [1:0]cnt88;
 reg [1:0]cnt77;
 reg [1:0]cnt66;
 reg [1:0]cnt55;
 reg [1:0]cnt44;
 reg [1:0]cnt33;
 reg [1:0]cnt22;
 reg [1:0]cnt11;
always@(posedge clk&en)begin//滤波器初始化
if(rst)begin//初始化
cnt11<=3;
cnt22<=3;
cnt33<=3;
cnt44<=3;
cnt55<=3;
cnt66<=3;
cnt77<=3;
cnt88<=3;
cnt99<=3;
for(i=0;i<LENGTH;i=i+1)begin
for(j=0;j<L;j=j+1)begin
sum1[i][j]<=0;
end
end
for(i=0;i<LENGTH;i=i+1)begin
for(k=0;k<TAP;k=k+1)begin
delay1[i][k]<=0;
end
end
for(i=0;i<LENGTH;i=i+1)begin
for(k=0;k<=INPUT_WIDTH;k=k+1)begin
addra1[i][k]<=0;
addra2[i][k]<=0;
end
end
for(i=0;i<LENGTH;i=i+1)begin
for(j=0;j<L;j=j+1)begin
for(k=0;k<=INPUT_WIDTH;k=k+1)begin
out1[i][j][k]<=0;
out2[i][j][k]<=0;
out[i][j][k]<=0;
sum[i][j][k]<=0;
end
end
end
for(i=0;i<LENGTH;i=i+1)begin
sum2[i]<=0;
end
end
end

always@(posedge clk9&en&l>=10)begin
if(!rst)begin
//滤波器1
for(k=0;k<TAP-1;k=k+1)begin
delay1[0][k+1]<=delay1[0][k];
end
delay1[0][0]<=x;
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
addra2[0][n]<={delay1[0][7][n],delay1[0][6][n],delay1[0][5][n],delay1[0][4][n]};
addra1[0][n]<={delay1[0][3][n],delay1[0][2][n],delay1[0][1][n],delay1[0][0][n]};
end
for(j=0;j<L;j=j+1)begin
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
out[0][j][n]<=out1[0][j][n]+out2[0][j][n];//前后相加
end
end
for(n=0;n<=INPUT_WIDTH;n=n+1)begin//查表
case(addra1[0][n])
0:out1[0][0][n]<=h0_0_0;
1:out1[0][0][n]<=h0_0_1;
2:out1[0][0][n]<=h0_0_2;
3:out1[0][0][n]<=h0_0_3;
4:out1[0][0][n]<=h0_0_4;
5:out1[0][0][n]<=h0_0_5;
6:out1[0][0][n]<=h0_0_6;
7:out1[0][0][n]<=h0_0_7;
8:out1[0][0][n]<=h0_0_8;
9:out1[0][0][n]<=h0_0_9;
10:out1[0][0][n]<=h0_0_10;
11:out1[0][0][n]<=h0_0_11;
12:out1[0][0][n]<=h0_0_12;
13:out1[0][0][n]<=h0_0_13;
14:out1[0][0][n]<=h0_0_14;
15:out1[0][0][n]<=h0_0_15;
endcase
case(addra1[0][n])
0:out1[0][1][n]<=h1_0_0;
1:out1[0][1][n]<=h1_0_1;
2:out1[0][1][n]<=h1_0_2;
3:out1[0][1][n]<=h1_0_3;
4:out1[0][1][n]<=h1_0_4;
5:out1[0][1][n]<=h1_0_5;
6:out1[0][1][n]<=h1_0_6;
7:out1[0][1][n]<=h1_0_7;
8:out1[0][1][n]<=h1_0_8;
9:out1[0][1][n]<=h1_0_9;
10:out1[0][1][n]<=h1_0_10;
11:out1[0][1][n]<=h1_0_11;
12:out1[0][1][n]<=h1_0_12;
13:out1[0][1][n]<=h1_0_13;
14:out1[0][1][n]<=h1_0_14;
15:out1[0][1][n]<=h1_0_15;
endcase
case(addra1[0][n])
0:out1[0][2][n]<=h2_0_0;
1:out1[0][2][n]<=h2_0_1;
2:out1[0][2][n]<=h2_0_2;
3:out1[0][2][n]<=h2_0_3;
4:out1[0][2][n]<=h2_0_4;
5:out1[0][2][n]<=h2_0_5;
6:out1[0][2][n]<=h2_0_6;
7:out1[0][2][n]<=h2_0_7;
8:out1[0][2][n]<=h2_0_8;
9:out1[0][2][n]<=h2_0_9;
10:out1[0][2][n]<=h2_0_10;
11:out1[0][2][n]<=h2_0_11;
12:out1[0][2][n]<=h2_0_12;
13:out1[0][2][n]<=h2_0_13;
14:out1[0][2][n]<=h2_0_14;
15:out1[0][2][n]<=h2_0_15;
endcase
case(addra1[0][n])
0:out1[0][3][n]<=h3_0_0;
1:out1[0][3][n]<=h3_0_1;
2:out1[0][3][n]<=h3_0_2;
3:out1[0][3][n]<=h3_0_3;
4:out1[0][3][n]<=h3_0_4;
5:out1[0][3][n]<=h3_0_5;
6:out1[0][3][n]<=h3_0_6;
7:out1[0][3][n]<=h3_0_7;
8:out1[0][3][n]<=h3_0_8;
9:out1[0][3][n]<=h3_0_9;
10:out1[0][3][n]<=h3_0_10;
11:out1[0][3][n]<=h3_0_11;
12:out1[0][3][n]<=h3_0_12;
13:out1[0][3][n]<=h3_0_13;
14:out1[0][3][n]<=h3_0_14;
15:out1[0][3][n]<=h3_0_15;
endcase
case(addra2[0][n])
0:out2[0][0][n]<=h0_1_0;
1:out2[0][0][n]<=h0_1_1;
2:out2[0][0][n]<=h0_1_2;
3:out2[0][0][n]<=h0_1_3;
4:out2[0][0][n]<=h0_1_4;
5:out2[0][0][n]<=h0_1_5;
6:out2[0][0][n]<=h0_1_6;
7:out2[0][0][n]<=h0_1_7;
8:out2[0][0][n]<=h0_1_8;
9:out2[0][0][n]<=h0_1_9;
10:out2[0][0][n]<=h0_1_10;
11:out2[0][0][n]<=h0_1_11;
12:out2[0][0][n]<=h0_1_12;
13:out2[0][0][n]<=h0_1_13;
14:out2[0][0][n]<=h0_1_14;
15:out2[0][0][n]<=h0_1_15;
endcase
case(addra2[0][n])
0:out2[0][1][n]<=h1_1_0;
1:out2[0][1][n]<=h1_1_1;
2:out2[0][1][n]<=h1_1_2;
3:out2[0][1][n]<=h1_1_3;
4:out2[0][1][n]<=h1_1_4;
5:out2[0][1][n]<=h1_1_5;
6:out2[0][1][n]<=h1_1_6;
7:out2[0][1][n]<=h1_1_7;
8:out2[0][1][n]<=h1_1_8;
9:out2[0][1][n]<=h1_1_9;
10:out2[0][1][n]<=h1_1_10;
11:out2[0][1][n]<=h1_1_11;
12:out2[0][1][n]<=h1_1_12;
13:out2[0][1][n]<=h1_1_13;
14:out2[0][1][n]<=h1_1_14;
15:out2[0][1][n]<=h1_1_15;
endcase
case(addra2[0][n])
0:out2[0][2][n]<=h2_1_0;
1:out2[0][2][n]<=h2_1_1;
2:out2[0][2][n]<=h2_1_2;
3:out2[0][2][n]<=h2_1_3;
4:out2[0][2][n]<=h2_1_4;
5:out2[0][2][n]<=h2_1_5;
6:out2[0][2][n]<=h2_1_6;
7:out2[0][2][n]<=h2_1_7;
8:out2[0][2][n]<=h2_1_8;
9:out2[0][2][n]<=h2_1_9;
10:out2[0][2][n]<=h2_1_10;
11:out2[0][2][n]<=h2_1_11;
12:out2[0][2][n]<=h2_1_12;
13:out2[0][2][n]<=h2_1_13;
14:out2[0][2][n]<=h2_1_14;
15:out2[0][2][n]<=h2_1_15;
endcase
case(addra2[0][n])
0:out2[0][3][n]<=h3_1_0;
1:out2[0][3][n]<=h3_1_1;
2:out2[0][3][n]<=h3_1_2;
3:out2[0][3][n]<=h3_1_3;
4:out2[0][3][n]<=h3_1_4;
5:out2[0][3][n]<=h3_1_5;
6:out2[0][3][n]<=h3_1_6;
7:out2[0][3][n]<=h3_1_7;
8:out2[0][3][n]<=h3_1_8;
9:out2[0][3][n]<=h3_1_9;
10:out2[0][3][n]<=h3_1_10;
11:out2[0][3][n]<=h3_1_11;
12:out2[0][3][n]<=h3_1_12;
13:out2[0][3][n]<=h3_1_13;
14:out2[0][3][n]<=h3_1_14;
15:out2[0][3][n]<=h3_1_15;
endcase
end
for(j=0;j<L;j=j+1)begin
sum[0][j][0]<=(out[0][j][0]>=0)?{15'b0,out[0][j][0][FILTER_WIDTH+1:0]}:{15'b111111111111111,out[0][j][0][FILTER_WIDTH+1:0]};
sum[0][j][1]<=(out[0][j][1]>=0)?{14'b0,out[0][j][1][FILTER_WIDTH+1:0],1'b0}:{14'b11111111111111,out[0][j][1][FILTER_WIDTH+1:0],1'b0};
sum[0][j][2]<=(out[0][j][2]>=0)?{13'b0,out[0][j][2][FILTER_WIDTH+1:0],2'b0}:{13'b1111111111111,out[0][j][2][FILTER_WIDTH+1:0],2'b0};
sum[0][j][3]<=(out[0][j][3]>=0)?{12'b0,out[0][j][3][FILTER_WIDTH+1:0],3'b0}:{12'b111111111111,out[0][j][3][FILTER_WIDTH+1:0],3'b0};
sum[0][j][4]<=(out[0][j][4]>=0)?{11'b0,out[0][j][4][FILTER_WIDTH+1:0],4'b0}:{11'b11111111111,out[0][j][4][FILTER_WIDTH+1:0],4'b0};
sum[0][j][5]<=(out[0][j][5]>=0)?{10'b0,out[0][j][5][FILTER_WIDTH+1:0],5'b0}:{10'b1111111111,out[0][j][5][FILTER_WIDTH+1:0],5'b0};
sum[0][j][6]<=(out[0][j][6]>=0)?{9'b0,out[0][j][6][FILTER_WIDTH+1:0],6'b0}:{9'b111111111,out[0][j][6][FILTER_WIDTH+1:0],6'b0};
sum[0][j][7]<=(out[0][j][7]>=0)?{8'b0,out[0][j][7][FILTER_WIDTH+1:0],7'b0}:{8'b11111111,out[0][j][7][FILTER_WIDTH+1:0],7'b0};
sum[0][j][8]<=(out[0][j][8]>=0)?{7'b0,out[0][j][8][FILTER_WIDTH+1:0],8'b0}:{7'b1111111,out[0][j][8][FILTER_WIDTH+1:0],8'b0};
sum[0][j][9]<=(out[0][j][9]>=0)?{6'b0,out[0][j][9][FILTER_WIDTH+1:0],9'b0}:{6'b111111,out[0][j][9][FILTER_WIDTH+1:0],9'b0};
sum[0][j][10]<=(out[0][j][10]>=0)?{5'b0,out[0][j][10][FILTER_WIDTH+1:0],10'b0}:{5'b11111,out[0][j][10][FILTER_WIDTH+1:0],10'b0};
sum[0][j][11]<=(out[0][j][11]>=0)?{4'b0,out[0][j][11][FILTER_WIDTH+1:0],11'b0}:{4'b1111,out[0][j][11][FILTER_WIDTH+1:0],11'b0};
sum[0][j][12]<=(out[0][j][12]>=0)?{3'b0,out[0][j][12][FILTER_WIDTH+1:0],12'b0}:{3'b111,out[0][j][12][FILTER_WIDTH+1:0],12'b0};
sum[0][j][13]<=(out[0][j][13]>=0)?{2'b0,out[0][j][13][FILTER_WIDTH+1:0],13'b0}:{2'b11,out[0][j][13][FILTER_WIDTH+1:0],13'b0};
sum[0][j][14]<=(out[0][j][14]>=0)?{1'b0,out[0][j][14][FILTER_WIDTH+1:0],14'b0}:{1'b1,out[0][j][14][FILTER_WIDTH+1:0],14'b0};
sum[0][j][15]<=-{out[0][j][15][FILTER_WIDTH+1:0],15'b0};
end
for(j=0;j<L;j=j+1)begin
sum1[0][j]<=sum[0][j][0]+sum[0][j][1]+sum[0][j][2]+sum[0][j][3]+sum[0][j][4]+sum[0][j][5]+sum[0][j][6]+sum[0][j][7]+sum[0][j][8]+sum[0][j][9]+sum[0][j][10]+sum[0][j][11]+sum[0][j][12]+sum[0][j][13]+sum[0][j][14]+sum[0][j][15];
end
end
end
always@(posedge clk8&en&l>=9)begin
if(!rst)begin
//移位1
cnt99<=cnt99+1;
if(l==9)begin
sum2[0]<={x,15'b0};
end
else begin
case(cnt99)
0:sum2[0]<=sum1[0][0];
1:sum2[0]<=sum1[0][1];
2:sum2[0]<=sum1[0][2];
3:sum2[0]<=sum1[0][3];
endcase
end
//滤波器2
for(k=0;k<TAP-1;k=k+1)begin
delay1[1][k+1]<=delay1[1][k];
end
delay1[1][0]<=(sum2[0]>=0)?sum2[0][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH-1]:{sum2[0][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH],1'b1};
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
addra2[1][n]<={delay1[1][7][n],delay1[1][6][n],delay1[1][5][n],delay1[1][4][n]};
addra1[1][n]<={delay1[1][3][n],delay1[1][2][n],delay1[1][1][n],delay1[1][0][n]};
end
for(j=0;j<L;j=j+1)begin
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
out[1][j][n]<=out1[1][j][n]+out2[1][j][n];//前后相加
end
end
for(n=0;n<=INPUT_WIDTH;n=n+1)begin//查表
case(addra1[1][n])
0:out1[1][0][n]<=h0_0_0;
1:out1[1][0][n]<=h0_0_1;
2:out1[1][0][n]<=h0_0_2;
3:out1[1][0][n]<=h0_0_3;
4:out1[1][0][n]<=h0_0_4;
5:out1[1][0][n]<=h0_0_5;
6:out1[1][0][n]<=h0_0_6;
7:out1[1][0][n]<=h0_0_7;
8:out1[1][0][n]<=h0_0_8;
9:out1[1][0][n]<=h0_0_9;
10:out1[1][0][n]<=h0_0_10;
11:out1[1][0][n]<=h0_0_11;
12:out1[1][0][n]<=h0_0_12;
13:out1[1][0][n]<=h0_0_13;
14:out1[1][0][n]<=h0_0_14;
15:out1[1][0][n]<=h0_0_15;
endcase
case(addra1[1][n])
0:out1[1][1][n]<=h1_0_0;
1:out1[1][1][n]<=h1_0_1;
2:out1[1][1][n]<=h1_0_2;
3:out1[1][1][n]<=h1_0_3;
4:out1[1][1][n]<=h1_0_4;
5:out1[1][1][n]<=h1_0_5;
6:out1[1][1][n]<=h1_0_6;
7:out1[1][1][n]<=h1_0_7;
8:out1[1][1][n]<=h1_0_8;
9:out1[1][1][n]<=h1_0_9;
10:out1[1][1][n]<=h1_0_10;
11:out1[1][1][n]<=h1_0_11;
12:out1[1][1][n]<=h1_0_12;
13:out1[1][1][n]<=h1_0_13;
14:out1[1][1][n]<=h1_0_14;
15:out1[1][1][n]<=h1_0_15;
endcase
case(addra1[1][n])
0:out1[1][2][n]<=h2_0_0;
1:out1[1][2][n]<=h2_0_1;
2:out1[1][2][n]<=h2_0_2;
3:out1[1][2][n]<=h2_0_3;
4:out1[1][2][n]<=h2_0_4;
5:out1[1][2][n]<=h2_0_5;
6:out1[1][2][n]<=h2_0_6;
7:out1[1][2][n]<=h2_0_7;
8:out1[1][2][n]<=h2_0_8;
9:out1[1][2][n]<=h2_0_9;
10:out1[1][2][n]<=h2_0_10;
11:out1[1][2][n]<=h2_0_11;
12:out1[1][2][n]<=h2_0_12;
13:out1[1][2][n]<=h2_0_13;
14:out1[1][2][n]<=h2_0_14;
15:out1[1][2][n]<=h2_0_15;
endcase
case(addra1[1][n])
0:out1[1][3][n]<=h3_0_0;
1:out1[1][3][n]<=h3_0_1;
2:out1[1][3][n]<=h3_0_2;
3:out1[1][3][n]<=h3_0_3;
4:out1[1][3][n]<=h3_0_4;
5:out1[1][3][n]<=h3_0_5;
6:out1[1][3][n]<=h3_0_6;
7:out1[1][3][n]<=h3_0_7;
8:out1[1][3][n]<=h3_0_8;
9:out1[1][3][n]<=h3_0_9;
10:out1[1][3][n]<=h3_0_10;
11:out1[1][3][n]<=h3_0_11;
12:out1[1][3][n]<=h3_0_12;
13:out1[1][3][n]<=h3_0_13;
14:out1[1][3][n]<=h3_0_14;
15:out1[1][3][n]<=h3_0_15;
endcase
case(addra2[1][n])
0:out2[1][0][n]<=h0_1_0;
1:out2[1][0][n]<=h0_1_1;
2:out2[1][0][n]<=h0_1_2;
3:out2[1][0][n]<=h0_1_3;
4:out2[1][0][n]<=h0_1_4;
5:out2[1][0][n]<=h0_1_5;
6:out2[1][0][n]<=h0_1_6;
7:out2[1][0][n]<=h0_1_7;
8:out2[1][0][n]<=h0_1_8;
9:out2[1][0][n]<=h0_1_9;
10:out2[1][0][n]<=h0_1_10;
11:out2[1][0][n]<=h0_1_11;
12:out2[1][0][n]<=h0_1_12;
13:out2[1][0][n]<=h0_1_13;
14:out2[1][0][n]<=h0_1_14;
15:out2[1][0][n]<=h0_1_15;
endcase
case(addra2[1][n])
0:out2[1][1][n]<=h1_1_0;
1:out2[1][1][n]<=h1_1_1;
2:out2[1][1][n]<=h1_1_2;
3:out2[1][1][n]<=h1_1_3;
4:out2[1][1][n]<=h1_1_4;
5:out2[1][1][n]<=h1_1_5;
6:out2[1][1][n]<=h1_1_6;
7:out2[1][1][n]<=h1_1_7;
8:out2[1][1][n]<=h1_1_8;
9:out2[1][1][n]<=h1_1_9;
10:out2[1][1][n]<=h1_1_10;
11:out2[1][1][n]<=h1_1_11;
12:out2[1][1][n]<=h1_1_12;
13:out2[1][1][n]<=h1_1_13;
14:out2[1][1][n]<=h1_1_14;
15:out2[1][1][n]<=h1_1_15;
endcase
case(addra2[1][n])
0:out2[1][2][n]<=h2_1_0;
1:out2[1][2][n]<=h2_1_1;
2:out2[1][2][n]<=h2_1_2;
3:out2[1][2][n]<=h2_1_3;
4:out2[1][2][n]<=h2_1_4;
5:out2[1][2][n]<=h2_1_5;
6:out2[1][2][n]<=h2_1_6;
7:out2[1][2][n]<=h2_1_7;
8:out2[1][2][n]<=h2_1_8;
9:out2[1][2][n]<=h2_1_9;
10:out2[1][2][n]<=h2_1_10;
11:out2[1][2][n]<=h2_1_11;
12:out2[1][2][n]<=h2_1_12;
13:out2[1][2][n]<=h2_1_13;
14:out2[1][2][n]<=h2_1_14;
15:out2[1][2][n]<=h2_1_15;
endcase
case(addra2[1][n])
0:out2[1][3][n]<=h3_1_0;
1:out2[1][3][n]<=h3_1_1;
2:out2[1][3][n]<=h3_1_2;
3:out2[1][3][n]<=h3_1_3;
4:out2[1][3][n]<=h3_1_4;
5:out2[1][3][n]<=h3_1_5;
6:out2[1][3][n]<=h3_1_6;
7:out2[1][3][n]<=h3_1_7;
8:out2[1][3][n]<=h3_1_8;
9:out2[1][3][n]<=h3_1_9;
10:out2[1][3][n]<=h3_1_10;
11:out2[1][3][n]<=h3_1_11;
12:out2[1][3][n]<=h3_1_12;
13:out2[1][3][n]<=h3_1_13;
14:out2[1][3][n]<=h3_1_14;
15:out2[1][3][n]<=h3_1_15;
endcase
end
for(j=0;j<L;j=j+1)begin
sum[1][j][0]<=(out[1][j][0]>=0)?{15'b0,out[1][j][0][FILTER_WIDTH+1:0]}:{15'b111111111111111,out[1][j][0][FILTER_WIDTH+1:0]};
sum[1][j][1]<=(out[1][j][1]>=0)?{14'b0,out[1][j][1][FILTER_WIDTH+1:0],1'b0}:{14'b11111111111111,out[1][j][1][FILTER_WIDTH+1:0],1'b0};
sum[1][j][2]<=(out[1][j][2]>=0)?{13'b0,out[1][j][2][FILTER_WIDTH+1:0],2'b0}:{13'b1111111111111,out[1][j][2][FILTER_WIDTH+1:0],2'b0};
sum[1][j][3]<=(out[1][j][3]>=0)?{12'b0,out[1][j][3][FILTER_WIDTH+1:0],3'b0}:{12'b111111111111,out[1][j][3][FILTER_WIDTH+1:0],3'b0};
sum[1][j][4]<=(out[1][j][4]>=0)?{11'b0,out[1][j][4][FILTER_WIDTH+1:0],4'b0}:{11'b11111111111,out[1][j][4][FILTER_WIDTH+1:0],4'b0};
sum[1][j][5]<=(out[1][j][5]>=0)?{10'b0,out[1][j][5][FILTER_WIDTH+1:0],5'b0}:{10'b1111111111,out[1][j][5][FILTER_WIDTH+1:0],5'b0};
sum[1][j][6]<=(out[1][j][6]>=0)?{9'b0,out[1][j][6][FILTER_WIDTH+1:0],6'b0}:{9'b111111111,out[1][j][6][FILTER_WIDTH+1:0],6'b0};
sum[1][j][7]<=(out[1][j][7]>=0)?{8'b0,out[1][j][7][FILTER_WIDTH+1:0],7'b0}:{8'b11111111,out[1][j][7][FILTER_WIDTH+1:0],7'b0};
sum[1][j][8]<=(out[1][j][8]>=0)?{7'b0,out[1][j][8][FILTER_WIDTH+1:0],8'b0}:{7'b1111111,out[1][j][8][FILTER_WIDTH+1:0],8'b0};
sum[1][j][9]<=(out[1][j][9]>=0)?{6'b0,out[1][j][9][FILTER_WIDTH+1:0],9'b0}:{6'b111111,out[1][j][9][FILTER_WIDTH+1:0],9'b0};
sum[1][j][10]<=(out[1][j][10]>=0)?{5'b0,out[1][j][10][FILTER_WIDTH+1:0],10'b0}:{5'b11111,out[1][j][10][FILTER_WIDTH+1:0],10'b0};
sum[1][j][11]<=(out[1][j][11]>=0)?{4'b0,out[1][j][11][FILTER_WIDTH+1:0],11'b0}:{4'b1111,out[1][j][11][FILTER_WIDTH+1:0],11'b0};
sum[1][j][12]<=(out[1][j][12]>=0)?{3'b0,out[1][j][12][FILTER_WIDTH+1:0],12'b0}:{3'b111,out[1][j][12][FILTER_WIDTH+1:0],12'b0};
sum[1][j][13]<=(out[1][j][13]>=0)?{2'b0,out[1][j][13][FILTER_WIDTH+1:0],13'b0}:{2'b11,out[1][j][13][FILTER_WIDTH+1:0],13'b0};
sum[1][j][14]<=(out[1][j][14]>=0)?{1'b0,out[1][j][14][FILTER_WIDTH+1:0],14'b0}:{1'b1,out[1][j][14][FILTER_WIDTH+1:0],14'b0};
sum[1][j][15]<=-{out[1][j][15][FILTER_WIDTH+1:0],15'b0};
end
for(j=0;j<L;j=j+1)begin
sum1[1][j]<=sum[1][j][0]+sum[1][j][1]+sum[1][j][2]+sum[1][j][3]+sum[1][j][4]+sum[1][j][5]+sum[1][j][6]+sum[1][j][7]+sum[1][j][8]+sum[1][j][9]+sum[1][j][10]+sum[1][j][11]+sum[1][j][12]+sum[1][j][13]+sum[1][j][14]+sum[1][j][15];
end
end
end
always@(posedge clk7&en&l>=8)begin
if(!rst)begin
//移位2
cnt88<=cnt88+1;
if(l==8)begin
sum2[1]<={x,15'b0};
end
else begin
case(cnt88)
0:sum2[1]<=sum1[1][0];
1:sum2[1]<=sum1[1][1];
2:sum2[1]<=sum1[1][2];
3:sum2[1]<=sum1[1][3];
endcase
end
//滤波器3
for(k=0;k<TAP-1;k=k+1)begin
delay1[2][k+1]<=delay1[2][k];
end
delay1[2][0]<=(sum2[1]>=0)?sum2[1][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH-1]:{sum2[1][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH],1'b1};
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
addra2[2][n]<={delay1[2][7][n],delay1[2][6][n],delay1[2][5][n],delay1[2][4][n]};
addra1[2][n]<={delay1[2][3][n],delay1[2][2][n],delay1[2][1][n],delay1[2][0][n]};
end
for(j=0;j<L;j=j+1)begin
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
out[2][j][n]<=out1[2][j][n]+out2[2][j][n];//前后相加
end
end
for(n=0;n<=INPUT_WIDTH;n=n+1)begin//查表
case(addra1[2][n])
0:out1[2][0][n]<=h0_0_0;
1:out1[2][0][n]<=h0_0_1;
2:out1[2][0][n]<=h0_0_2;
3:out1[2][0][n]<=h0_0_3;
4:out1[2][0][n]<=h0_0_4;
5:out1[2][0][n]<=h0_0_5;
6:out1[2][0][n]<=h0_0_6;
7:out1[2][0][n]<=h0_0_7;
8:out1[2][0][n]<=h0_0_8;
9:out1[2][0][n]<=h0_0_9;
10:out1[2][0][n]<=h0_0_10;
11:out1[2][0][n]<=h0_0_11;
12:out1[2][0][n]<=h0_0_12;
13:out1[2][0][n]<=h0_0_13;
14:out1[2][0][n]<=h0_0_14;
15:out1[2][0][n]<=h0_0_15;
endcase
case(addra1[2][n])
0:out1[2][1][n]<=h1_0_0;
1:out1[2][1][n]<=h1_0_1;
2:out1[2][1][n]<=h1_0_2;
3:out1[2][1][n]<=h1_0_3;
4:out1[2][1][n]<=h1_0_4;
5:out1[2][1][n]<=h1_0_5;
6:out1[2][1][n]<=h1_0_6;
7:out1[2][1][n]<=h1_0_7;
8:out1[2][1][n]<=h1_0_8;
9:out1[2][1][n]<=h1_0_9;
10:out1[2][1][n]<=h1_0_10;
11:out1[2][1][n]<=h1_0_11;
12:out1[2][1][n]<=h1_0_12;
13:out1[2][1][n]<=h1_0_13;
14:out1[2][1][n]<=h1_0_14;
15:out1[2][1][n]<=h1_0_15;
endcase
case(addra1[2][n])
0:out1[2][2][n]<=h2_0_0;
1:out1[2][2][n]<=h2_0_1;
2:out1[2][2][n]<=h2_0_2;
3:out1[2][2][n]<=h2_0_3;
4:out1[2][2][n]<=h2_0_4;
5:out1[2][2][n]<=h2_0_5;
6:out1[2][2][n]<=h2_0_6;
7:out1[2][2][n]<=h2_0_7;
8:out1[2][2][n]<=h2_0_8;
9:out1[2][2][n]<=h2_0_9;
10:out1[2][2][n]<=h2_0_10;
11:out1[2][2][n]<=h2_0_11;
12:out1[2][2][n]<=h2_0_12;
13:out1[2][2][n]<=h2_0_13;
14:out1[2][2][n]<=h2_0_14;
15:out1[2][2][n]<=h2_0_15;
endcase
case(addra1[2][n])
0:out1[2][3][n]<=h3_0_0;
1:out1[2][3][n]<=h3_0_1;
2:out1[2][3][n]<=h3_0_2;
3:out1[2][3][n]<=h3_0_3;
4:out1[2][3][n]<=h3_0_4;
5:out1[2][3][n]<=h3_0_5;
6:out1[2][3][n]<=h3_0_6;
7:out1[2][3][n]<=h3_0_7;
8:out1[2][3][n]<=h3_0_8;
9:out1[2][3][n]<=h3_0_9;
10:out1[2][3][n]<=h3_0_10;
11:out1[2][3][n]<=h3_0_11;
12:out1[2][3][n]<=h3_0_12;
13:out1[2][3][n]<=h3_0_13;
14:out1[2][3][n]<=h3_0_14;
15:out1[2][3][n]<=h3_0_15;
endcase
case(addra2[2][n])
0:out2[2][0][n]<=h0_1_0;
1:out2[2][0][n]<=h0_1_1;
2:out2[2][0][n]<=h0_1_2;
3:out2[2][0][n]<=h0_1_3;
4:out2[2][0][n]<=h0_1_4;
5:out2[2][0][n]<=h0_1_5;
6:out2[2][0][n]<=h0_1_6;
7:out2[2][0][n]<=h0_1_7;
8:out2[2][0][n]<=h0_1_8;
9:out2[2][0][n]<=h0_1_9;
10:out2[2][0][n]<=h0_1_10;
11:out2[2][0][n]<=h0_1_11;
12:out2[2][0][n]<=h0_1_12;
13:out2[2][0][n]<=h0_1_13;
14:out2[2][0][n]<=h0_1_14;
15:out2[2][0][n]<=h0_1_15;
endcase
case(addra2[2][n])
0:out2[2][1][n]<=h1_1_0;
1:out2[2][1][n]<=h1_1_1;
2:out2[2][1][n]<=h1_1_2;
3:out2[2][1][n]<=h1_1_3;
4:out2[2][1][n]<=h1_1_4;
5:out2[2][1][n]<=h1_1_5;
6:out2[2][1][n]<=h1_1_6;
7:out2[2][1][n]<=h1_1_7;
8:out2[2][1][n]<=h1_1_8;
9:out2[2][1][n]<=h1_1_9;
10:out2[2][1][n]<=h1_1_10;
11:out2[2][1][n]<=h1_1_11;
12:out2[2][1][n]<=h1_1_12;
13:out2[2][1][n]<=h1_1_13;
14:out2[2][1][n]<=h1_1_14;
15:out2[2][1][n]<=h1_1_15;
endcase
case(addra2[2][n])
0:out2[2][2][n]<=h2_1_0;
1:out2[2][2][n]<=h2_1_1;
2:out2[2][2][n]<=h2_1_2;
3:out2[2][2][n]<=h2_1_3;
4:out2[2][2][n]<=h2_1_4;
5:out2[2][2][n]<=h2_1_5;
6:out2[2][2][n]<=h2_1_6;
7:out2[2][2][n]<=h2_1_7;
8:out2[2][2][n]<=h2_1_8;
9:out2[2][2][n]<=h2_1_9;
10:out2[2][2][n]<=h2_1_10;
11:out2[2][2][n]<=h2_1_11;
12:out2[2][2][n]<=h2_1_12;
13:out2[2][2][n]<=h2_1_13;
14:out2[2][2][n]<=h2_1_14;
15:out2[2][2][n]<=h2_1_15;
endcase
case(addra2[2][n])
0:out2[2][3][n]<=h3_1_0;
1:out2[2][3][n]<=h3_1_1;
2:out2[2][3][n]<=h3_1_2;
3:out2[2][3][n]<=h3_1_3;
4:out2[2][3][n]<=h3_1_4;
5:out2[2][3][n]<=h3_1_5;
6:out2[2][3][n]<=h3_1_6;
7:out2[2][3][n]<=h3_1_7;
8:out2[2][3][n]<=h3_1_8;
9:out2[2][3][n]<=h3_1_9;
10:out2[2][3][n]<=h3_1_10;
11:out2[2][3][n]<=h3_1_11;
12:out2[2][3][n]<=h3_1_12;
13:out2[2][3][n]<=h3_1_13;
14:out2[2][3][n]<=h3_1_14;
15:out2[2][3][n]<=h3_1_15;
endcase
end
for(j=0;j<L;j=j+1)begin
sum[2][j][0]<=(out[2][j][0]>=0)?{15'b0,out[2][j][0][FILTER_WIDTH+1:0]}:{15'b111111111111111,out[2][j][0][FILTER_WIDTH+1:0]};
sum[2][j][1]<=(out[2][j][1]>=0)?{14'b0,out[2][j][1][FILTER_WIDTH+1:0],1'b0}:{14'b11111111111111,out[2][j][1][FILTER_WIDTH+1:0],1'b0};
sum[2][j][2]<=(out[2][j][2]>=0)?{13'b0,out[2][j][2][FILTER_WIDTH+1:0],2'b0}:{13'b1111111111111,out[2][j][2][FILTER_WIDTH+1:0],2'b0};
sum[2][j][3]<=(out[2][j][3]>=0)?{12'b0,out[2][j][3][FILTER_WIDTH+1:0],3'b0}:{12'b111111111111,out[2][j][3][FILTER_WIDTH+1:0],3'b0};
sum[2][j][4]<=(out[2][j][4]>=0)?{11'b0,out[2][j][4][FILTER_WIDTH+1:0],4'b0}:{11'b11111111111,out[2][j][4][FILTER_WIDTH+1:0],4'b0};
sum[2][j][5]<=(out[2][j][5]>=0)?{10'b0,out[2][j][5][FILTER_WIDTH+1:0],5'b0}:{10'b1111111111,out[2][j][5][FILTER_WIDTH+1:0],5'b0};
sum[2][j][6]<=(out[2][j][6]>=0)?{9'b0,out[2][j][6][FILTER_WIDTH+1:0],6'b0}:{9'b111111111,out[2][j][6][FILTER_WIDTH+1:0],6'b0};
sum[2][j][7]<=(out[2][j][7]>=0)?{8'b0,out[2][j][7][FILTER_WIDTH+1:0],7'b0}:{8'b11111111,out[2][j][7][FILTER_WIDTH+1:0],7'b0};
sum[2][j][8]<=(out[2][j][8]>=0)?{7'b0,out[2][j][8][FILTER_WIDTH+1:0],8'b0}:{7'b1111111,out[2][j][8][FILTER_WIDTH+1:0],8'b0};
sum[2][j][9]<=(out[2][j][9]>=0)?{6'b0,out[2][j][9][FILTER_WIDTH+1:0],9'b0}:{6'b111111,out[2][j][9][FILTER_WIDTH+1:0],9'b0};
sum[2][j][10]<=(out[2][j][10]>=0)?{5'b0,out[2][j][10][FILTER_WIDTH+1:0],10'b0}:{5'b11111,out[2][j][10][FILTER_WIDTH+1:0],10'b0};
sum[2][j][11]<=(out[2][j][11]>=0)?{4'b0,out[2][j][11][FILTER_WIDTH+1:0],11'b0}:{4'b1111,out[2][j][11][FILTER_WIDTH+1:0],11'b0};
sum[2][j][12]<=(out[2][j][12]>=0)?{3'b0,out[2][j][12][FILTER_WIDTH+1:0],12'b0}:{3'b111,out[2][j][12][FILTER_WIDTH+1:0],12'b0};
sum[2][j][13]<=(out[2][j][13]>=0)?{2'b0,out[2][j][13][FILTER_WIDTH+1:0],13'b0}:{2'b11,out[2][j][13][FILTER_WIDTH+1:0],13'b0};
sum[2][j][14]<=(out[2][j][14]>=0)?{1'b0,out[2][j][14][FILTER_WIDTH+1:0],14'b0}:{1'b1,out[2][j][14][FILTER_WIDTH+1:0],14'b0};
sum[2][j][15]<=-{out[2][j][15][FILTER_WIDTH+1:0],15'b0};
end
for(j=0;j<L;j=j+1)begin
sum1[2][j]<=sum[2][j][0]+sum[2][j][1]+sum[2][j][2]+sum[2][j][3]+sum[2][j][4]+sum[2][j][5]+sum[2][j][6]+sum[2][j][7]+sum[2][j][8]+sum[2][j][9]+sum[2][j][10]+sum[2][j][11]+sum[2][j][12]+sum[2][j][13]+sum[2][j][14]+sum[2][j][15];
end
end
end
always@(posedge clk6&en&l>=7)begin
if(!rst)begin
//移位3
cnt77<=cnt77+1;
if(l==7)begin
sum2[2]<={x,15'b0};
end
else begin
case(cnt77)
0:sum2[2]<=sum1[2][0];
1:sum2[2]<=sum1[2][1];
2:sum2[2]<=sum1[2][2];
3:sum2[2]<=sum1[2][3];
endcase
end
//滤波器4
for(k=0;k<TAP-1;k=k+1)begin
delay1[3][k+1]<=delay1[3][k];
end
delay1[3][0]<=(sum2[2]>=0)?sum2[2][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH-1]:{sum2[2][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH],1'b1};
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
addra2[3][n]<={delay1[3][7][n],delay1[3][6][n],delay1[3][5][n],delay1[3][4][n]};
addra1[3][n]<={delay1[3][3][n],delay1[3][2][n],delay1[3][1][n],delay1[3][0][n]};
end
for(j=0;j<L;j=j+1)begin
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
out[3][j][n]<=out1[3][j][n]+out2[3][j][n];//前后相加
end
end
for(n=0;n<=INPUT_WIDTH;n=n+1)begin//查表
case(addra1[3][n])
0:out1[3][0][n]<=h0_0_0;
1:out1[3][0][n]<=h0_0_1;
2:out1[3][0][n]<=h0_0_2;
3:out1[3][0][n]<=h0_0_3;
4:out1[3][0][n]<=h0_0_4;
5:out1[3][0][n]<=h0_0_5;
6:out1[3][0][n]<=h0_0_6;
7:out1[3][0][n]<=h0_0_7;
8:out1[3][0][n]<=h0_0_8;
9:out1[3][0][n]<=h0_0_9;
10:out1[3][0][n]<=h0_0_10;
11:out1[3][0][n]<=h0_0_11;
12:out1[3][0][n]<=h0_0_12;
13:out1[3][0][n]<=h0_0_13;
14:out1[3][0][n]<=h0_0_14;
15:out1[3][0][n]<=h0_0_15;
endcase
case(addra1[3][n])
0:out1[3][1][n]<=h1_0_0;
1:out1[3][1][n]<=h1_0_1;
2:out1[3][1][n]<=h1_0_2;
3:out1[3][1][n]<=h1_0_3;
4:out1[3][1][n]<=h1_0_4;
5:out1[3][1][n]<=h1_0_5;
6:out1[3][1][n]<=h1_0_6;
7:out1[3][1][n]<=h1_0_7;
8:out1[3][1][n]<=h1_0_8;
9:out1[3][1][n]<=h1_0_9;
10:out1[3][1][n]<=h1_0_10;
11:out1[3][1][n]<=h1_0_11;
12:out1[3][1][n]<=h1_0_12;
13:out1[3][1][n]<=h1_0_13;
14:out1[3][1][n]<=h1_0_14;
15:out1[3][1][n]<=h1_0_15;
endcase
case(addra1[3][n])
0:out1[3][2][n]<=h2_0_0;
1:out1[3][2][n]<=h2_0_1;
2:out1[3][2][n]<=h2_0_2;
3:out1[3][2][n]<=h2_0_3;
4:out1[3][2][n]<=h2_0_4;
5:out1[3][2][n]<=h2_0_5;
6:out1[3][2][n]<=h2_0_6;
7:out1[3][2][n]<=h2_0_7;
8:out1[3][2][n]<=h2_0_8;
9:out1[3][2][n]<=h2_0_9;
10:out1[3][2][n]<=h2_0_10;
11:out1[3][2][n]<=h2_0_11;
12:out1[3][2][n]<=h2_0_12;
13:out1[3][2][n]<=h2_0_13;
14:out1[3][2][n]<=h2_0_14;
15:out1[3][2][n]<=h2_0_15;
endcase
case(addra1[3][n])
0:out1[3][3][n]<=h3_0_0;
1:out1[3][3][n]<=h3_0_1;
2:out1[3][3][n]<=h3_0_2;
3:out1[3][3][n]<=h3_0_3;
4:out1[3][3][n]<=h3_0_4;
5:out1[3][3][n]<=h3_0_5;
6:out1[3][3][n]<=h3_0_6;
7:out1[3][3][n]<=h3_0_7;
8:out1[3][3][n]<=h3_0_8;
9:out1[3][3][n]<=h3_0_9;
10:out1[3][3][n]<=h3_0_10;
11:out1[3][3][n]<=h3_0_11;
12:out1[3][3][n]<=h3_0_12;
13:out1[3][3][n]<=h3_0_13;
14:out1[3][3][n]<=h3_0_14;
15:out1[3][3][n]<=h3_0_15;
endcase
case(addra2[3][n])
0:out2[3][0][n]<=h0_1_0;
1:out2[3][0][n]<=h0_1_1;
2:out2[3][0][n]<=h0_1_2;
3:out2[3][0][n]<=h0_1_3;
4:out2[3][0][n]<=h0_1_4;
5:out2[3][0][n]<=h0_1_5;
6:out2[3][0][n]<=h0_1_6;
7:out2[3][0][n]<=h0_1_7;
8:out2[3][0][n]<=h0_1_8;
9:out2[3][0][n]<=h0_1_9;
10:out2[3][0][n]<=h0_1_10;
11:out2[3][0][n]<=h0_1_11;
12:out2[3][0][n]<=h0_1_12;
13:out2[3][0][n]<=h0_1_13;
14:out2[3][0][n]<=h0_1_14;
15:out2[3][0][n]<=h0_1_15;
endcase
case(addra2[3][n])
0:out2[3][1][n]<=h1_1_0;
1:out2[3][1][n]<=h1_1_1;
2:out2[3][1][n]<=h1_1_2;
3:out2[3][1][n]<=h1_1_3;
4:out2[3][1][n]<=h1_1_4;
5:out2[3][1][n]<=h1_1_5;
6:out2[3][1][n]<=h1_1_6;
7:out2[3][1][n]<=h1_1_7;
8:out2[3][1][n]<=h1_1_8;
9:out2[3][1][n]<=h1_1_9;
10:out2[3][1][n]<=h1_1_10;
11:out2[3][1][n]<=h1_1_11;
12:out2[3][1][n]<=h1_1_12;
13:out2[3][1][n]<=h1_1_13;
14:out2[3][1][n]<=h1_1_14;
15:out2[3][1][n]<=h1_1_15;
endcase
case(addra2[3][n])
0:out2[3][2][n]<=h2_1_0;
1:out2[3][2][n]<=h2_1_1;
2:out2[3][2][n]<=h2_1_2;
3:out2[3][2][n]<=h2_1_3;
4:out2[3][2][n]<=h2_1_4;
5:out2[3][2][n]<=h2_1_5;
6:out2[3][2][n]<=h2_1_6;
7:out2[3][2][n]<=h2_1_7;
8:out2[3][2][n]<=h2_1_8;
9:out2[3][2][n]<=h2_1_9;
10:out2[3][2][n]<=h2_1_10;
11:out2[3][2][n]<=h2_1_11;
12:out2[3][2][n]<=h2_1_12;
13:out2[3][2][n]<=h2_1_13;
14:out2[3][2][n]<=h2_1_14;
15:out2[3][2][n]<=h2_1_15;
endcase
case(addra2[3][n])
0:out2[3][3][n]<=h3_1_0;
1:out2[3][3][n]<=h3_1_1;
2:out2[3][3][n]<=h3_1_2;
3:out2[3][3][n]<=h3_1_3;
4:out2[3][3][n]<=h3_1_4;
5:out2[3][3][n]<=h3_1_5;
6:out2[3][3][n]<=h3_1_6;
7:out2[3][3][n]<=h3_1_7;
8:out2[3][3][n]<=h3_1_8;
9:out2[3][3][n]<=h3_1_9;
10:out2[3][3][n]<=h3_1_10;
11:out2[3][3][n]<=h3_1_11;
12:out2[3][3][n]<=h3_1_12;
13:out2[3][3][n]<=h3_1_13;
14:out2[3][3][n]<=h3_1_14;
15:out2[3][3][n]<=h3_1_15;
endcase
end
for(j=0;j<L;j=j+1)begin
sum[3][j][0]<=(out[3][j][0]>=0)?{15'b0,out[3][j][0][FILTER_WIDTH+1:0]}:{15'b111111111111111,out[3][j][0][FILTER_WIDTH+1:0]};
sum[3][j][1]<=(out[3][j][1]>=0)?{14'b0,out[3][j][1][FILTER_WIDTH+1:0],1'b0}:{14'b11111111111111,out[3][j][1][FILTER_WIDTH+1:0],1'b0};
sum[3][j][2]<=(out[3][j][2]>=0)?{13'b0,out[3][j][2][FILTER_WIDTH+1:0],2'b0}:{13'b1111111111111,out[3][j][2][FILTER_WIDTH+1:0],2'b0};
sum[3][j][3]<=(out[3][j][3]>=0)?{12'b0,out[3][j][3][FILTER_WIDTH+1:0],3'b0}:{12'b111111111111,out[3][j][3][FILTER_WIDTH+1:0],3'b0};
sum[3][j][4]<=(out[3][j][4]>=0)?{11'b0,out[3][j][4][FILTER_WIDTH+1:0],4'b0}:{11'b11111111111,out[3][j][4][FILTER_WIDTH+1:0],4'b0};
sum[3][j][5]<=(out[3][j][5]>=0)?{10'b0,out[3][j][5][FILTER_WIDTH+1:0],5'b0}:{10'b1111111111,out[3][j][5][FILTER_WIDTH+1:0],5'b0};
sum[3][j][6]<=(out[3][j][6]>=0)?{9'b0,out[3][j][6][FILTER_WIDTH+1:0],6'b0}:{9'b111111111,out[3][j][6][FILTER_WIDTH+1:0],6'b0};
sum[3][j][7]<=(out[3][j][7]>=0)?{8'b0,out[3][j][7][FILTER_WIDTH+1:0],7'b0}:{8'b11111111,out[3][j][7][FILTER_WIDTH+1:0],7'b0};
sum[3][j][8]<=(out[3][j][8]>=0)?{7'b0,out[3][j][8][FILTER_WIDTH+1:0],8'b0}:{7'b1111111,out[3][j][8][FILTER_WIDTH+1:0],8'b0};
sum[3][j][9]<=(out[3][j][9]>=0)?{6'b0,out[3][j][9][FILTER_WIDTH+1:0],9'b0}:{6'b111111,out[3][j][9][FILTER_WIDTH+1:0],9'b0};
sum[3][j][10]<=(out[3][j][10]>=0)?{5'b0,out[3][j][10][FILTER_WIDTH+1:0],10'b0}:{5'b11111,out[3][j][10][FILTER_WIDTH+1:0],10'b0};
sum[3][j][11]<=(out[3][j][11]>=0)?{4'b0,out[3][j][11][FILTER_WIDTH+1:0],11'b0}:{4'b1111,out[3][j][11][FILTER_WIDTH+1:0],11'b0};
sum[3][j][12]<=(out[3][j][12]>=0)?{3'b0,out[3][j][12][FILTER_WIDTH+1:0],12'b0}:{3'b111,out[3][j][12][FILTER_WIDTH+1:0],12'b0};
sum[3][j][13]<=(out[3][j][13]>=0)?{2'b0,out[3][j][13][FILTER_WIDTH+1:0],13'b0}:{2'b11,out[3][j][13][FILTER_WIDTH+1:0],13'b0};
sum[3][j][14]<=(out[3][j][14]>=0)?{1'b0,out[3][j][14][FILTER_WIDTH+1:0],14'b0}:{1'b1,out[3][j][14][FILTER_WIDTH+1:0],14'b0};
sum[3][j][15]<=-{out[3][j][15][FILTER_WIDTH+1:0],15'b0};
end
for(j=0;j<L;j=j+1)begin
sum1[3][j]<=sum[3][j][0]+sum[3][j][1]+sum[3][j][2]+sum[3][j][3]+sum[3][j][4]+sum[3][j][5]+sum[3][j][6]+sum[3][j][7]+sum[3][j][8]+sum[3][j][9]+sum[3][j][10]+sum[3][j][11]+sum[3][j][12]+sum[3][j][13]+sum[3][j][14]+sum[3][j][15];
end
end
end
always@(posedge clk5&en&l>=6)begin
if(!rst)begin
//移位4
cnt66<=cnt66+1;
if(l==6)begin
sum2[3]<={x,15'b0};
end
else begin
case(cnt66)
0:sum2[3]<=sum1[3][0];
1:sum2[3]<=sum1[3][1];
2:sum2[3]<=sum1[3][2];
3:sum2[3]<=sum1[3][3];
endcase
end
//滤波器5
for(k=0;k<TAP-1;k=k+1)begin
delay1[4][k+1]<=delay1[4][k];
end
delay1[4][0]<=(sum2[3]>=0)?sum2[3][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH-1]:{sum2[3][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH],1'b1};
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
addra2[4][n]<={delay1[4][7][n],delay1[4][6][n],delay1[4][5][n],delay1[4][4][n]};
addra1[4][n]<={delay1[4][3][n],delay1[4][2][n],delay1[4][1][n],delay1[4][0][n]};
end
for(j=0;j<L;j=j+1)begin
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
out[4][j][n]<=out1[4][j][n]+out2[4][j][n];//前后相加
end
end
for(n=0;n<=INPUT_WIDTH;n=n+1)begin//查表
case(addra1[4][n])
0:out1[4][0][n]<=h0_0_0;
1:out1[4][0][n]<=h0_0_1;
2:out1[4][0][n]<=h0_0_2;
3:out1[4][0][n]<=h0_0_3;
4:out1[4][0][n]<=h0_0_4;
5:out1[4][0][n]<=h0_0_5;
6:out1[4][0][n]<=h0_0_6;
7:out1[4][0][n]<=h0_0_7;
8:out1[4][0][n]<=h0_0_8;
9:out1[4][0][n]<=h0_0_9;
10:out1[4][0][n]<=h0_0_10;
11:out1[4][0][n]<=h0_0_11;
12:out1[4][0][n]<=h0_0_12;
13:out1[4][0][n]<=h0_0_13;
14:out1[4][0][n]<=h0_0_14;
15:out1[4][0][n]<=h0_0_15;
endcase
case(addra1[4][n])
0:out1[4][1][n]<=h1_0_0;
1:out1[4][1][n]<=h1_0_1;
2:out1[4][1][n]<=h1_0_2;
3:out1[4][1][n]<=h1_0_3;
4:out1[4][1][n]<=h1_0_4;
5:out1[4][1][n]<=h1_0_5;
6:out1[4][1][n]<=h1_0_6;
7:out1[4][1][n]<=h1_0_7;
8:out1[4][1][n]<=h1_0_8;
9:out1[4][1][n]<=h1_0_9;
10:out1[4][1][n]<=h1_0_10;
11:out1[4][1][n]<=h1_0_11;
12:out1[4][1][n]<=h1_0_12;
13:out1[4][1][n]<=h1_0_13;
14:out1[4][1][n]<=h1_0_14;
15:out1[4][1][n]<=h1_0_15;
endcase
case(addra1[4][n])
0:out1[4][2][n]<=h2_0_0;
1:out1[4][2][n]<=h2_0_1;
2:out1[4][2][n]<=h2_0_2;
3:out1[4][2][n]<=h2_0_3;
4:out1[4][2][n]<=h2_0_4;
5:out1[4][2][n]<=h2_0_5;
6:out1[4][2][n]<=h2_0_6;
7:out1[4][2][n]<=h2_0_7;
8:out1[4][2][n]<=h2_0_8;
9:out1[4][2][n]<=h2_0_9;
10:out1[4][2][n]<=h2_0_10;
11:out1[4][2][n]<=h2_0_11;
12:out1[4][2][n]<=h2_0_12;
13:out1[4][2][n]<=h2_0_13;
14:out1[4][2][n]<=h2_0_14;
15:out1[4][2][n]<=h2_0_15;
endcase
case(addra1[4][n])
0:out1[4][3][n]<=h3_0_0;
1:out1[4][3][n]<=h3_0_1;
2:out1[4][3][n]<=h3_0_2;
3:out1[4][3][n]<=h3_0_3;
4:out1[4][3][n]<=h3_0_4;
5:out1[4][3][n]<=h3_0_5;
6:out1[4][3][n]<=h3_0_6;
7:out1[4][3][n]<=h3_0_7;
8:out1[4][3][n]<=h3_0_8;
9:out1[4][3][n]<=h3_0_9;
10:out1[4][3][n]<=h3_0_10;
11:out1[4][3][n]<=h3_0_11;
12:out1[4][3][n]<=h3_0_12;
13:out1[4][3][n]<=h3_0_13;
14:out1[4][3][n]<=h3_0_14;
15:out1[4][3][n]<=h3_0_15;
endcase
case(addra2[4][n])
0:out2[4][0][n]<=h0_1_0;
1:out2[4][0][n]<=h0_1_1;
2:out2[4][0][n]<=h0_1_2;
3:out2[4][0][n]<=h0_1_3;
4:out2[4][0][n]<=h0_1_4;
5:out2[4][0][n]<=h0_1_5;
6:out2[4][0][n]<=h0_1_6;
7:out2[4][0][n]<=h0_1_7;
8:out2[4][0][n]<=h0_1_8;
9:out2[4][0][n]<=h0_1_9;
10:out2[4][0][n]<=h0_1_10;
11:out2[4][0][n]<=h0_1_11;
12:out2[4][0][n]<=h0_1_12;
13:out2[4][0][n]<=h0_1_13;
14:out2[4][0][n]<=h0_1_14;
15:out2[4][0][n]<=h0_1_15;
endcase
case(addra2[4][n])
0:out2[4][1][n]<=h1_1_0;
1:out2[4][1][n]<=h1_1_1;
2:out2[4][1][n]<=h1_1_2;
3:out2[4][1][n]<=h1_1_3;
4:out2[4][1][n]<=h1_1_4;
5:out2[4][1][n]<=h1_1_5;
6:out2[4][1][n]<=h1_1_6;
7:out2[4][1][n]<=h1_1_7;
8:out2[4][1][n]<=h1_1_8;
9:out2[4][1][n]<=h1_1_9;
10:out2[4][1][n]<=h1_1_10;
11:out2[4][1][n]<=h1_1_11;
12:out2[4][1][n]<=h1_1_12;
13:out2[4][1][n]<=h1_1_13;
14:out2[4][1][n]<=h1_1_14;
15:out2[4][1][n]<=h1_1_15;
endcase
case(addra2[4][n])
0:out2[4][2][n]<=h2_1_0;
1:out2[4][2][n]<=h2_1_1;
2:out2[4][2][n]<=h2_1_2;
3:out2[4][2][n]<=h2_1_3;
4:out2[4][2][n]<=h2_1_4;
5:out2[4][2][n]<=h2_1_5;
6:out2[4][2][n]<=h2_1_6;
7:out2[4][2][n]<=h2_1_7;
8:out2[4][2][n]<=h2_1_8;
9:out2[4][2][n]<=h2_1_9;
10:out2[4][2][n]<=h2_1_10;
11:out2[4][2][n]<=h2_1_11;
12:out2[4][2][n]<=h2_1_12;
13:out2[4][2][n]<=h2_1_13;
14:out2[4][2][n]<=h2_1_14;
15:out2[4][2][n]<=h2_1_15;
endcase
case(addra2[4][n])
0:out2[4][3][n]<=h3_1_0;
1:out2[4][3][n]<=h3_1_1;
2:out2[4][3][n]<=h3_1_2;
3:out2[4][3][n]<=h3_1_3;
4:out2[4][3][n]<=h3_1_4;
5:out2[4][3][n]<=h3_1_5;
6:out2[4][3][n]<=h3_1_6;
7:out2[4][3][n]<=h3_1_7;
8:out2[4][3][n]<=h3_1_8;
9:out2[4][3][n]<=h3_1_9;
10:out2[4][3][n]<=h3_1_10;
11:out2[4][3][n]<=h3_1_11;
12:out2[4][3][n]<=h3_1_12;
13:out2[4][3][n]<=h3_1_13;
14:out2[4][3][n]<=h3_1_14;
15:out2[4][3][n]<=h3_1_15;
endcase
end
for(j=0;j<L;j=j+1)begin
sum[4][j][0]<=(out[4][j][0]>=0)?{15'b0,out[4][j][0][FILTER_WIDTH+1:0]}:{15'b111111111111111,out[4][j][0][FILTER_WIDTH+1:0]};
sum[4][j][1]<=(out[4][j][1]>=0)?{14'b0,out[4][j][1][FILTER_WIDTH+1:0],1'b0}:{14'b11111111111111,out[4][j][1][FILTER_WIDTH+1:0],1'b0};
sum[4][j][2]<=(out[4][j][2]>=0)?{13'b0,out[4][j][2][FILTER_WIDTH+1:0],2'b0}:{13'b1111111111111,out[4][j][2][FILTER_WIDTH+1:0],2'b0};
sum[4][j][3]<=(out[4][j][3]>=0)?{12'b0,out[4][j][3][FILTER_WIDTH+1:0],3'b0}:{12'b111111111111,out[4][j][3][FILTER_WIDTH+1:0],3'b0};
sum[4][j][4]<=(out[4][j][4]>=0)?{11'b0,out[4][j][4][FILTER_WIDTH+1:0],4'b0}:{11'b11111111111,out[4][j][4][FILTER_WIDTH+1:0],4'b0};
sum[4][j][5]<=(out[4][j][5]>=0)?{10'b0,out[4][j][5][FILTER_WIDTH+1:0],5'b0}:{10'b1111111111,out[4][j][5][FILTER_WIDTH+1:0],5'b0};
sum[4][j][6]<=(out[4][j][6]>=0)?{9'b0,out[4][j][6][FILTER_WIDTH+1:0],6'b0}:{9'b111111111,out[4][j][6][FILTER_WIDTH+1:0],6'b0};
sum[4][j][7]<=(out[4][j][7]>=0)?{8'b0,out[4][j][7][FILTER_WIDTH+1:0],7'b0}:{8'b11111111,out[4][j][7][FILTER_WIDTH+1:0],7'b0};
sum[4][j][8]<=(out[4][j][8]>=0)?{7'b0,out[4][j][8][FILTER_WIDTH+1:0],8'b0}:{7'b1111111,out[4][j][8][FILTER_WIDTH+1:0],8'b0};
sum[4][j][9]<=(out[4][j][9]>=0)?{6'b0,out[4][j][9][FILTER_WIDTH+1:0],9'b0}:{6'b111111,out[4][j][9][FILTER_WIDTH+1:0],9'b0};
sum[4][j][10]<=(out[4][j][10]>=0)?{5'b0,out[4][j][10][FILTER_WIDTH+1:0],10'b0}:{5'b11111,out[4][j][10][FILTER_WIDTH+1:0],10'b0};
sum[4][j][11]<=(out[4][j][11]>=0)?{4'b0,out[4][j][11][FILTER_WIDTH+1:0],11'b0}:{4'b1111,out[4][j][11][FILTER_WIDTH+1:0],11'b0};
sum[4][j][12]<=(out[4][j][12]>=0)?{3'b0,out[4][j][12][FILTER_WIDTH+1:0],12'b0}:{3'b111,out[4][j][12][FILTER_WIDTH+1:0],12'b0};
sum[4][j][13]<=(out[4][j][13]>=0)?{2'b0,out[4][j][13][FILTER_WIDTH+1:0],13'b0}:{2'b11,out[4][j][13][FILTER_WIDTH+1:0],13'b0};
sum[4][j][14]<=(out[4][j][14]>=0)?{1'b0,out[4][j][14][FILTER_WIDTH+1:0],14'b0}:{1'b1,out[4][j][14][FILTER_WIDTH+1:0],14'b0};
sum[4][j][15]<=-{out[4][j][15][FILTER_WIDTH+1:0],15'b0};
end
for(j=0;j<L;j=j+1)begin
sum1[4][j]<=sum[4][j][0]+sum[4][j][1]+sum[4][j][2]+sum[4][j][3]+sum[4][j][4]+sum[4][j][5]+sum[4][j][6]+sum[4][j][7]+sum[4][j][8]+sum[4][j][9]+sum[4][j][10]+sum[4][j][11]+sum[4][j][12]+sum[4][j][13]+sum[4][j][14]+sum[4][j][15];
end
end
end
always@(posedge clk4&en&l>=5)begin
if(!rst)begin
//移位5
cnt55<=cnt55+1;
if(l==5)begin
sum2[4]<={x,15'b0};
end
else begin
case(cnt55)
0:sum2[4]<=sum1[4][0];
1:sum2[4]<=sum1[4][1];
2:sum2[4]<=sum1[4][2];
3:sum2[4]<=sum1[4][3];
endcase
end
//滤波器6
for(k=0;k<TAP-1;k=k+1)begin
delay1[5][k+1]<=delay1[5][k];
end
delay1[5][0]<=(sum2[4]>=0)?sum2[4][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH-1]:{sum2[4][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH],1'b1};
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
addra2[5][n]<={delay1[5][7][n],delay1[5][6][n],delay1[5][5][n],delay1[5][4][n]};
addra1[5][n]<={delay1[5][3][n],delay1[5][2][n],delay1[5][1][n],delay1[5][0][n]};
end
for(j=0;j<L;j=j+1)begin
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
out[5][j][n]<=out1[5][j][n]+out2[5][j][n];//前后相加
end
end
for(n=0;n<=INPUT_WIDTH;n=n+1)begin//查表
case(addra1[5][n])
0:out1[5][0][n]<=h0_0_0;
1:out1[5][0][n]<=h0_0_1;
2:out1[5][0][n]<=h0_0_2;
3:out1[5][0][n]<=h0_0_3;
4:out1[5][0][n]<=h0_0_4;
5:out1[5][0][n]<=h0_0_5;
6:out1[5][0][n]<=h0_0_6;
7:out1[5][0][n]<=h0_0_7;
8:out1[5][0][n]<=h0_0_8;
9:out1[5][0][n]<=h0_0_9;
10:out1[5][0][n]<=h0_0_10;
11:out1[5][0][n]<=h0_0_11;
12:out1[5][0][n]<=h0_0_12;
13:out1[5][0][n]<=h0_0_13;
14:out1[5][0][n]<=h0_0_14;
15:out1[5][0][n]<=h0_0_15;
endcase
case(addra1[5][n])
0:out1[5][1][n]<=h1_0_0;
1:out1[5][1][n]<=h1_0_1;
2:out1[5][1][n]<=h1_0_2;
3:out1[5][1][n]<=h1_0_3;
4:out1[5][1][n]<=h1_0_4;
5:out1[5][1][n]<=h1_0_5;
6:out1[5][1][n]<=h1_0_6;
7:out1[5][1][n]<=h1_0_7;
8:out1[5][1][n]<=h1_0_8;
9:out1[5][1][n]<=h1_0_9;
10:out1[5][1][n]<=h1_0_10;
11:out1[5][1][n]<=h1_0_11;
12:out1[5][1][n]<=h1_0_12;
13:out1[5][1][n]<=h1_0_13;
14:out1[5][1][n]<=h1_0_14;
15:out1[5][1][n]<=h1_0_15;
endcase
case(addra1[5][n])
0:out1[5][2][n]<=h2_0_0;
1:out1[5][2][n]<=h2_0_1;
2:out1[5][2][n]<=h2_0_2;
3:out1[5][2][n]<=h2_0_3;
4:out1[5][2][n]<=h2_0_4;
5:out1[5][2][n]<=h2_0_5;
6:out1[5][2][n]<=h2_0_6;
7:out1[5][2][n]<=h2_0_7;
8:out1[5][2][n]<=h2_0_8;
9:out1[5][2][n]<=h2_0_9;
10:out1[5][2][n]<=h2_0_10;
11:out1[5][2][n]<=h2_0_11;
12:out1[5][2][n]<=h2_0_12;
13:out1[5][2][n]<=h2_0_13;
14:out1[5][2][n]<=h2_0_14;
15:out1[5][2][n]<=h2_0_15;
endcase
case(addra1[5][n])
0:out1[5][3][n]<=h3_0_0;
1:out1[5][3][n]<=h3_0_1;
2:out1[5][3][n]<=h3_0_2;
3:out1[5][3][n]<=h3_0_3;
4:out1[5][3][n]<=h3_0_4;
5:out1[5][3][n]<=h3_0_5;
6:out1[5][3][n]<=h3_0_6;
7:out1[5][3][n]<=h3_0_7;
8:out1[5][3][n]<=h3_0_8;
9:out1[5][3][n]<=h3_0_9;
10:out1[5][3][n]<=h3_0_10;
11:out1[5][3][n]<=h3_0_11;
12:out1[5][3][n]<=h3_0_12;
13:out1[5][3][n]<=h3_0_13;
14:out1[5][3][n]<=h3_0_14;
15:out1[5][3][n]<=h3_0_15;
endcase
case(addra2[5][n])
0:out2[5][0][n]<=h0_1_0;
1:out2[5][0][n]<=h0_1_1;
2:out2[5][0][n]<=h0_1_2;
3:out2[5][0][n]<=h0_1_3;
4:out2[5][0][n]<=h0_1_4;
5:out2[5][0][n]<=h0_1_5;
6:out2[5][0][n]<=h0_1_6;
7:out2[5][0][n]<=h0_1_7;
8:out2[5][0][n]<=h0_1_8;
9:out2[5][0][n]<=h0_1_9;
10:out2[5][0][n]<=h0_1_10;
11:out2[5][0][n]<=h0_1_11;
12:out2[5][0][n]<=h0_1_12;
13:out2[5][0][n]<=h0_1_13;
14:out2[5][0][n]<=h0_1_14;
15:out2[5][0][n]<=h0_1_15;
endcase
case(addra2[5][n])
0:out2[5][1][n]<=h1_1_0;
1:out2[5][1][n]<=h1_1_1;
2:out2[5][1][n]<=h1_1_2;
3:out2[5][1][n]<=h1_1_3;
4:out2[5][1][n]<=h1_1_4;
5:out2[5][1][n]<=h1_1_5;
6:out2[5][1][n]<=h1_1_6;
7:out2[5][1][n]<=h1_1_7;
8:out2[5][1][n]<=h1_1_8;
9:out2[5][1][n]<=h1_1_9;
10:out2[5][1][n]<=h1_1_10;
11:out2[5][1][n]<=h1_1_11;
12:out2[5][1][n]<=h1_1_12;
13:out2[5][1][n]<=h1_1_13;
14:out2[5][1][n]<=h1_1_14;
15:out2[5][1][n]<=h1_1_15;
endcase
case(addra2[5][n])
0:out2[5][2][n]<=h2_1_0;
1:out2[5][2][n]<=h2_1_1;
2:out2[5][2][n]<=h2_1_2;
3:out2[5][2][n]<=h2_1_3;
4:out2[5][2][n]<=h2_1_4;
5:out2[5][2][n]<=h2_1_5;
6:out2[5][2][n]<=h2_1_6;
7:out2[5][2][n]<=h2_1_7;
8:out2[5][2][n]<=h2_1_8;
9:out2[5][2][n]<=h2_1_9;
10:out2[5][2][n]<=h2_1_10;
11:out2[5][2][n]<=h2_1_11;
12:out2[5][2][n]<=h2_1_12;
13:out2[5][2][n]<=h2_1_13;
14:out2[5][2][n]<=h2_1_14;
15:out2[5][2][n]<=h2_1_15;
endcase
case(addra2[5][n])
0:out2[5][3][n]<=h3_1_0;
1:out2[5][3][n]<=h3_1_1;
2:out2[5][3][n]<=h3_1_2;
3:out2[5][3][n]<=h3_1_3;
4:out2[5][3][n]<=h3_1_4;
5:out2[5][3][n]<=h3_1_5;
6:out2[5][3][n]<=h3_1_6;
7:out2[5][3][n]<=h3_1_7;
8:out2[5][3][n]<=h3_1_8;
9:out2[5][3][n]<=h3_1_9;
10:out2[5][3][n]<=h3_1_10;
11:out2[5][3][n]<=h3_1_11;
12:out2[5][3][n]<=h3_1_12;
13:out2[5][3][n]<=h3_1_13;
14:out2[5][3][n]<=h3_1_14;
15:out2[5][3][n]<=h3_1_15;
endcase
end
for(j=0;j<L;j=j+1)begin
sum[5][j][0]<=(out[5][j][0]>=0)?{15'b0,out[5][j][0][FILTER_WIDTH+1:0]}:{15'b111111111111111,out[5][j][0][FILTER_WIDTH+1:0]};
sum[5][j][1]<=(out[5][j][1]>=0)?{14'b0,out[5][j][1][FILTER_WIDTH+1:0],1'b0}:{14'b11111111111111,out[5][j][1][FILTER_WIDTH+1:0],1'b0};
sum[5][j][2]<=(out[5][j][2]>=0)?{13'b0,out[5][j][2][FILTER_WIDTH+1:0],2'b0}:{13'b1111111111111,out[5][j][2][FILTER_WIDTH+1:0],2'b0};
sum[5][j][3]<=(out[5][j][3]>=0)?{12'b0,out[5][j][3][FILTER_WIDTH+1:0],3'b0}:{12'b111111111111,out[5][j][3][FILTER_WIDTH+1:0],3'b0};
sum[5][j][4]<=(out[5][j][4]>=0)?{11'b0,out[5][j][4][FILTER_WIDTH+1:0],4'b0}:{11'b11111111111,out[5][j][4][FILTER_WIDTH+1:0],4'b0};
sum[5][j][5]<=(out[5][j][5]>=0)?{10'b0,out[5][j][5][FILTER_WIDTH+1:0],5'b0}:{10'b1111111111,out[5][j][5][FILTER_WIDTH+1:0],5'b0};
sum[5][j][6]<=(out[5][j][6]>=0)?{9'b0,out[5][j][6][FILTER_WIDTH+1:0],6'b0}:{9'b111111111,out[5][j][6][FILTER_WIDTH+1:0],6'b0};
sum[5][j][7]<=(out[5][j][7]>=0)?{8'b0,out[5][j][7][FILTER_WIDTH+1:0],7'b0}:{8'b11111111,out[5][j][7][FILTER_WIDTH+1:0],7'b0};
sum[5][j][8]<=(out[5][j][8]>=0)?{7'b0,out[5][j][8][FILTER_WIDTH+1:0],8'b0}:{7'b1111111,out[5][j][8][FILTER_WIDTH+1:0],8'b0};
sum[5][j][9]<=(out[5][j][9]>=0)?{6'b0,out[5][j][9][FILTER_WIDTH+1:0],9'b0}:{6'b111111,out[5][j][9][FILTER_WIDTH+1:0],9'b0};
sum[5][j][10]<=(out[5][j][10]>=0)?{5'b0,out[5][j][10][FILTER_WIDTH+1:0],10'b0}:{5'b11111,out[5][j][10][FILTER_WIDTH+1:0],10'b0};
sum[5][j][11]<=(out[5][j][11]>=0)?{4'b0,out[5][j][11][FILTER_WIDTH+1:0],11'b0}:{4'b1111,out[5][j][11][FILTER_WIDTH+1:0],11'b0};
sum[5][j][12]<=(out[5][j][12]>=0)?{3'b0,out[5][j][12][FILTER_WIDTH+1:0],12'b0}:{3'b111,out[5][j][12][FILTER_WIDTH+1:0],12'b0};
sum[5][j][13]<=(out[5][j][13]>=0)?{2'b0,out[5][j][13][FILTER_WIDTH+1:0],13'b0}:{2'b11,out[5][j][13][FILTER_WIDTH+1:0],13'b0};
sum[5][j][14]<=(out[5][j][14]>=0)?{1'b0,out[5][j][14][FILTER_WIDTH+1:0],14'b0}:{1'b1,out[5][j][14][FILTER_WIDTH+1:0],14'b0};
sum[5][j][15]<=-{out[5][j][15][FILTER_WIDTH+1:0],15'b0};
end
for(j=0;j<L;j=j+1)begin
sum1[5][j]<=sum[5][j][0]+sum[5][j][1]+sum[5][j][2]+sum[5][j][3]+sum[5][j][4]+sum[5][j][5]+sum[5][j][6]+sum[5][j][7]+sum[5][j][8]+sum[5][j][9]+sum[5][j][10]+sum[5][j][11]+sum[5][j][12]+sum[5][j][13]+sum[5][j][14]+sum[5][j][15];
end
end
end
always@(posedge clk3&en&l>=4)begin
if(!rst)begin
//移位6
cnt44<=cnt44+1;
if(l==4)begin
sum2[5]<={x,15'b0};
end
else begin
case(cnt44)
0:sum2[5]<=sum1[5][0];
1:sum2[5]<=sum1[5][1];
2:sum2[5]<=sum1[5][2];
3:sum2[5]<=sum1[5][3];
endcase
end
//滤波器7
for(k=0;k<TAP-1;k=k+1)begin
delay1[6][k+1]<=delay1[6][k];
end
delay1[6][0]<=(sum2[5]>=0)?sum2[5][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH-1]:{sum2[5][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH],1'b1};
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
addra2[6][n]<={delay1[6][7][n],delay1[6][6][n],delay1[6][5][n],delay1[6][4][n]};
addra1[6][n]<={delay1[6][3][n],delay1[6][2][n],delay1[6][1][n],delay1[6][0][n]};
end
for(j=0;j<L;j=j+1)begin
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
out[6][j][n]<=out1[6][j][n]+out2[6][j][n];//前后相加
end
end
for(n=0;n<=INPUT_WIDTH;n=n+1)begin//查表
case(addra1[6][n])
0:out1[6][0][n]<=h0_0_0;
1:out1[6][0][n]<=h0_0_1;
2:out1[6][0][n]<=h0_0_2;
3:out1[6][0][n]<=h0_0_3;
4:out1[6][0][n]<=h0_0_4;
5:out1[6][0][n]<=h0_0_5;
6:out1[6][0][n]<=h0_0_6;
7:out1[6][0][n]<=h0_0_7;
8:out1[6][0][n]<=h0_0_8;
9:out1[6][0][n]<=h0_0_9;
10:out1[6][0][n]<=h0_0_10;
11:out1[6][0][n]<=h0_0_11;
12:out1[6][0][n]<=h0_0_12;
13:out1[6][0][n]<=h0_0_13;
14:out1[6][0][n]<=h0_0_14;
15:out1[6][0][n]<=h0_0_15;
endcase
case(addra1[6][n])
0:out1[6][1][n]<=h1_0_0;
1:out1[6][1][n]<=h1_0_1;
2:out1[6][1][n]<=h1_0_2;
3:out1[6][1][n]<=h1_0_3;
4:out1[6][1][n]<=h1_0_4;
5:out1[6][1][n]<=h1_0_5;
6:out1[6][1][n]<=h1_0_6;
7:out1[6][1][n]<=h1_0_7;
8:out1[6][1][n]<=h1_0_8;
9:out1[6][1][n]<=h1_0_9;
10:out1[6][1][n]<=h1_0_10;
11:out1[6][1][n]<=h1_0_11;
12:out1[6][1][n]<=h1_0_12;
13:out1[6][1][n]<=h1_0_13;
14:out1[6][1][n]<=h1_0_14;
15:out1[6][1][n]<=h1_0_15;
endcase
case(addra1[6][n])
0:out1[6][2][n]<=h2_0_0;
1:out1[6][2][n]<=h2_0_1;
2:out1[6][2][n]<=h2_0_2;
3:out1[6][2][n]<=h2_0_3;
4:out1[6][2][n]<=h2_0_4;
5:out1[6][2][n]<=h2_0_5;
6:out1[6][2][n]<=h2_0_6;
7:out1[6][2][n]<=h2_0_7;
8:out1[6][2][n]<=h2_0_8;
9:out1[6][2][n]<=h2_0_9;
10:out1[6][2][n]<=h2_0_10;
11:out1[6][2][n]<=h2_0_11;
12:out1[6][2][n]<=h2_0_12;
13:out1[6][2][n]<=h2_0_13;
14:out1[6][2][n]<=h2_0_14;
15:out1[6][2][n]<=h2_0_15;
endcase
case(addra1[6][n])
0:out1[6][3][n]<=h3_0_0;
1:out1[6][3][n]<=h3_0_1;
2:out1[6][3][n]<=h3_0_2;
3:out1[6][3][n]<=h3_0_3;
4:out1[6][3][n]<=h3_0_4;
5:out1[6][3][n]<=h3_0_5;
6:out1[6][3][n]<=h3_0_6;
7:out1[6][3][n]<=h3_0_7;
8:out1[6][3][n]<=h3_0_8;
9:out1[6][3][n]<=h3_0_9;
10:out1[6][3][n]<=h3_0_10;
11:out1[6][3][n]<=h3_0_11;
12:out1[6][3][n]<=h3_0_12;
13:out1[6][3][n]<=h3_0_13;
14:out1[6][3][n]<=h3_0_14;
15:out1[6][3][n]<=h3_0_15;
endcase
case(addra2[6][n])
0:out2[6][0][n]<=h0_1_0;
1:out2[6][0][n]<=h0_1_1;
2:out2[6][0][n]<=h0_1_2;
3:out2[6][0][n]<=h0_1_3;
4:out2[6][0][n]<=h0_1_4;
5:out2[6][0][n]<=h0_1_5;
6:out2[6][0][n]<=h0_1_6;
7:out2[6][0][n]<=h0_1_7;
8:out2[6][0][n]<=h0_1_8;
9:out2[6][0][n]<=h0_1_9;
10:out2[6][0][n]<=h0_1_10;
11:out2[6][0][n]<=h0_1_11;
12:out2[6][0][n]<=h0_1_12;
13:out2[6][0][n]<=h0_1_13;
14:out2[6][0][n]<=h0_1_14;
15:out2[6][0][n]<=h0_1_15;
endcase
case(addra2[6][n])
0:out2[6][1][n]<=h1_1_0;
1:out2[6][1][n]<=h1_1_1;
2:out2[6][1][n]<=h1_1_2;
3:out2[6][1][n]<=h1_1_3;
4:out2[6][1][n]<=h1_1_4;
5:out2[6][1][n]<=h1_1_5;
6:out2[6][1][n]<=h1_1_6;
7:out2[6][1][n]<=h1_1_7;
8:out2[6][1][n]<=h1_1_8;
9:out2[6][1][n]<=h1_1_9;
10:out2[6][1][n]<=h1_1_10;
11:out2[6][1][n]<=h1_1_11;
12:out2[6][1][n]<=h1_1_12;
13:out2[6][1][n]<=h1_1_13;
14:out2[6][1][n]<=h1_1_14;
15:out2[6][1][n]<=h1_1_15;
endcase
case(addra2[6][n])
0:out2[6][2][n]<=h2_1_0;
1:out2[6][2][n]<=h2_1_1;
2:out2[6][2][n]<=h2_1_2;
3:out2[6][2][n]<=h2_1_3;
4:out2[6][2][n]<=h2_1_4;
5:out2[6][2][n]<=h2_1_5;
6:out2[6][2][n]<=h2_1_6;
7:out2[6][2][n]<=h2_1_7;
8:out2[6][2][n]<=h2_1_8;
9:out2[6][2][n]<=h2_1_9;
10:out2[6][2][n]<=h2_1_10;
11:out2[6][2][n]<=h2_1_11;
12:out2[6][2][n]<=h2_1_12;
13:out2[6][2][n]<=h2_1_13;
14:out2[6][2][n]<=h2_1_14;
15:out2[6][2][n]<=h2_1_15;
endcase
case(addra2[6][n])
0:out2[6][3][n]<=h3_1_0;
1:out2[6][3][n]<=h3_1_1;
2:out2[6][3][n]<=h3_1_2;
3:out2[6][3][n]<=h3_1_3;
4:out2[6][3][n]<=h3_1_4;
5:out2[6][3][n]<=h3_1_5;
6:out2[6][3][n]<=h3_1_6;
7:out2[6][3][n]<=h3_1_7;
8:out2[6][3][n]<=h3_1_8;
9:out2[6][3][n]<=h3_1_9;
10:out2[6][3][n]<=h3_1_10;
11:out2[6][3][n]<=h3_1_11;
12:out2[6][3][n]<=h3_1_12;
13:out2[6][3][n]<=h3_1_13;
14:out2[6][3][n]<=h3_1_14;
15:out2[6][3][n]<=h3_1_15;
endcase
end
for(j=0;j<L;j=j+1)begin
sum[6][j][0]<=(out[6][j][0]>=0)?{15'b0,out[6][j][0][FILTER_WIDTH+1:0]}:{15'b111111111111111,out[6][j][0][FILTER_WIDTH+1:0]};
sum[6][j][1]<=(out[6][j][1]>=0)?{14'b0,out[6][j][1][FILTER_WIDTH+1:0],1'b0}:{14'b11111111111111,out[6][j][1][FILTER_WIDTH+1:0],1'b0};
sum[6][j][2]<=(out[6][j][2]>=0)?{13'b0,out[6][j][2][FILTER_WIDTH+1:0],2'b0}:{13'b1111111111111,out[6][j][2][FILTER_WIDTH+1:0],2'b0};
sum[6][j][3]<=(out[6][j][3]>=0)?{12'b0,out[6][j][3][FILTER_WIDTH+1:0],3'b0}:{12'b111111111111,out[6][j][3][FILTER_WIDTH+1:0],3'b0};
sum[6][j][4]<=(out[6][j][4]>=0)?{11'b0,out[6][j][4][FILTER_WIDTH+1:0],4'b0}:{11'b11111111111,out[6][j][4][FILTER_WIDTH+1:0],4'b0};
sum[6][j][5]<=(out[6][j][5]>=0)?{10'b0,out[6][j][5][FILTER_WIDTH+1:0],5'b0}:{10'b1111111111,out[6][j][5][FILTER_WIDTH+1:0],5'b0};
sum[6][j][6]<=(out[6][j][6]>=0)?{9'b0,out[6][j][6][FILTER_WIDTH+1:0],6'b0}:{9'b111111111,out[6][j][6][FILTER_WIDTH+1:0],6'b0};
sum[6][j][7]<=(out[6][j][7]>=0)?{8'b0,out[6][j][7][FILTER_WIDTH+1:0],7'b0}:{8'b11111111,out[6][j][7][FILTER_WIDTH+1:0],7'b0};
sum[6][j][8]<=(out[6][j][8]>=0)?{7'b0,out[6][j][8][FILTER_WIDTH+1:0],8'b0}:{7'b1111111,out[6][j][8][FILTER_WIDTH+1:0],8'b0};
sum[6][j][9]<=(out[6][j][9]>=0)?{6'b0,out[6][j][9][FILTER_WIDTH+1:0],9'b0}:{6'b111111,out[6][j][9][FILTER_WIDTH+1:0],9'b0};
sum[6][j][10]<=(out[6][j][10]>=0)?{5'b0,out[6][j][10][FILTER_WIDTH+1:0],10'b0}:{5'b11111,out[6][j][10][FILTER_WIDTH+1:0],10'b0};
sum[6][j][11]<=(out[6][j][11]>=0)?{4'b0,out[6][j][11][FILTER_WIDTH+1:0],11'b0}:{4'b1111,out[6][j][11][FILTER_WIDTH+1:0],11'b0};
sum[6][j][12]<=(out[6][j][12]>=0)?{3'b0,out[6][j][12][FILTER_WIDTH+1:0],12'b0}:{3'b111,out[6][j][12][FILTER_WIDTH+1:0],12'b0};
sum[6][j][13]<=(out[6][j][13]>=0)?{2'b0,out[6][j][13][FILTER_WIDTH+1:0],13'b0}:{2'b11,out[6][j][13][FILTER_WIDTH+1:0],13'b0};
sum[6][j][14]<=(out[6][j][14]>=0)?{1'b0,out[6][j][14][FILTER_WIDTH+1:0],14'b0}:{1'b1,out[6][j][14][FILTER_WIDTH+1:0],14'b0};
sum[6][j][15]<=-{out[6][j][15][FILTER_WIDTH+1:0],15'b0};
end
for(j=0;j<L;j=j+1)begin
sum1[6][j]<=sum[6][j][0]+sum[6][j][1]+sum[6][j][2]+sum[6][j][3]+sum[6][j][4]+sum[6][j][5]+sum[6][j][6]+sum[6][j][7]+sum[6][j][8]+sum[6][j][9]+sum[6][j][10]+sum[6][j][11]+sum[6][j][12]+sum[6][j][13]+sum[6][j][14]+sum[6][j][15];
end
end
end
always@(posedge clk2&en&l>=3)begin
if(!rst)begin
//移位7
cnt33<=cnt33+1;
if(l==3)begin
sum2[6]<={x,15'b0};
end
else begin
case(cnt33)
0:sum2[6]<=sum1[6][0];
1:sum2[6]<=sum1[6][1];
2:sum2[6]<=sum1[6][2];
3:sum2[6]<=sum1[6][3];
endcase
end
//滤波器8
for(k=0;k<TAP-1;k=k+1)begin
delay1[7][k+1]<=delay1[7][k];
end
delay1[7][0]<=(sum2[6]>=0)?sum2[6][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH-1]:{sum2[6][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH],1'b1};
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
addra2[7][n]<={delay1[7][7][n],delay1[7][6][n],delay1[7][5][n],delay1[7][4][n]};
addra1[7][n]<={delay1[7][3][n],delay1[7][2][n],delay1[7][1][n],delay1[7][0][n]};
end
for(j=0;j<L;j=j+1)begin
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
out[7][j][n]<=out1[7][j][n]+out2[7][j][n];//前后相加
end
end
for(n=0;n<=INPUT_WIDTH;n=n+1)begin//查表
case(addra1[7][n])
0:out1[7][0][n]<=h0_0_0;
1:out1[7][0][n]<=h0_0_1;
2:out1[7][0][n]<=h0_0_2;
3:out1[7][0][n]<=h0_0_3;
4:out1[7][0][n]<=h0_0_4;
5:out1[7][0][n]<=h0_0_5;
6:out1[7][0][n]<=h0_0_6;
7:out1[7][0][n]<=h0_0_7;
8:out1[7][0][n]<=h0_0_8;
9:out1[7][0][n]<=h0_0_9;
10:out1[7][0][n]<=h0_0_10;
11:out1[7][0][n]<=h0_0_11;
12:out1[7][0][n]<=h0_0_12;
13:out1[7][0][n]<=h0_0_13;
14:out1[7][0][n]<=h0_0_14;
15:out1[7][0][n]<=h0_0_15;
endcase
case(addra1[7][n])
0:out1[7][1][n]<=h1_0_0;
1:out1[7][1][n]<=h1_0_1;
2:out1[7][1][n]<=h1_0_2;
3:out1[7][1][n]<=h1_0_3;
4:out1[7][1][n]<=h1_0_4;
5:out1[7][1][n]<=h1_0_5;
6:out1[7][1][n]<=h1_0_6;
7:out1[7][1][n]<=h1_0_7;
8:out1[7][1][n]<=h1_0_8;
9:out1[7][1][n]<=h1_0_9;
10:out1[7][1][n]<=h1_0_10;
11:out1[7][1][n]<=h1_0_11;
12:out1[7][1][n]<=h1_0_12;
13:out1[7][1][n]<=h1_0_13;
14:out1[7][1][n]<=h1_0_14;
15:out1[7][1][n]<=h1_0_15;
endcase
case(addra1[7][n])
0:out1[7][2][n]<=h2_0_0;
1:out1[7][2][n]<=h2_0_1;
2:out1[7][2][n]<=h2_0_2;
3:out1[7][2][n]<=h2_0_3;
4:out1[7][2][n]<=h2_0_4;
5:out1[7][2][n]<=h2_0_5;
6:out1[7][2][n]<=h2_0_6;
7:out1[7][2][n]<=h2_0_7;
8:out1[7][2][n]<=h2_0_8;
9:out1[7][2][n]<=h2_0_9;
10:out1[7][2][n]<=h2_0_10;
11:out1[7][2][n]<=h2_0_11;
12:out1[7][2][n]<=h2_0_12;
13:out1[7][2][n]<=h2_0_13;
14:out1[7][2][n]<=h2_0_14;
15:out1[7][2][n]<=h2_0_15;
endcase
case(addra1[7][n])
0:out1[7][3][n]<=h3_0_0;
1:out1[7][3][n]<=h3_0_1;
2:out1[7][3][n]<=h3_0_2;
3:out1[7][3][n]<=h3_0_3;
4:out1[7][3][n]<=h3_0_4;
5:out1[7][3][n]<=h3_0_5;
6:out1[7][3][n]<=h3_0_6;
7:out1[7][3][n]<=h3_0_7;
8:out1[7][3][n]<=h3_0_8;
9:out1[7][3][n]<=h3_0_9;
10:out1[7][3][n]<=h3_0_10;
11:out1[7][3][n]<=h3_0_11;
12:out1[7][3][n]<=h3_0_12;
13:out1[7][3][n]<=h3_0_13;
14:out1[7][3][n]<=h3_0_14;
15:out1[7][3][n]<=h3_0_15;
endcase
case(addra2[7][n])
0:out2[7][0][n]<=h0_1_0;
1:out2[7][0][n]<=h0_1_1;
2:out2[7][0][n]<=h0_1_2;
3:out2[7][0][n]<=h0_1_3;
4:out2[7][0][n]<=h0_1_4;
5:out2[7][0][n]<=h0_1_5;
6:out2[7][0][n]<=h0_1_6;
7:out2[7][0][n]<=h0_1_7;
8:out2[7][0][n]<=h0_1_8;
9:out2[7][0][n]<=h0_1_9;
10:out2[7][0][n]<=h0_1_10;
11:out2[7][0][n]<=h0_1_11;
12:out2[7][0][n]<=h0_1_12;
13:out2[7][0][n]<=h0_1_13;
14:out2[7][0][n]<=h0_1_14;
15:out2[7][0][n]<=h0_1_15;
endcase
case(addra2[7][n])
0:out2[7][1][n]<=h1_1_0;
1:out2[7][1][n]<=h1_1_1;
2:out2[7][1][n]<=h1_1_2;
3:out2[7][1][n]<=h1_1_3;
4:out2[7][1][n]<=h1_1_4;
5:out2[7][1][n]<=h1_1_5;
6:out2[7][1][n]<=h1_1_6;
7:out2[7][1][n]<=h1_1_7;
8:out2[7][1][n]<=h1_1_8;
9:out2[7][1][n]<=h1_1_9;
10:out2[7][1][n]<=h1_1_10;
11:out2[7][1][n]<=h1_1_11;
12:out2[7][1][n]<=h1_1_12;
13:out2[7][1][n]<=h1_1_13;
14:out2[7][1][n]<=h1_1_14;
15:out2[7][1][n]<=h1_1_15;
endcase
case(addra2[7][n])
0:out2[7][2][n]<=h2_1_0;
1:out2[7][2][n]<=h2_1_1;
2:out2[7][2][n]<=h2_1_2;
3:out2[7][2][n]<=h2_1_3;
4:out2[7][2][n]<=h2_1_4;
5:out2[7][2][n]<=h2_1_5;
6:out2[7][2][n]<=h2_1_6;
7:out2[7][2][n]<=h2_1_7;
8:out2[7][2][n]<=h2_1_8;
9:out2[7][2][n]<=h2_1_9;
10:out2[7][2][n]<=h2_1_10;
11:out2[7][2][n]<=h2_1_11;
12:out2[7][2][n]<=h2_1_12;
13:out2[7][2][n]<=h2_1_13;
14:out2[7][2][n]<=h2_1_14;
15:out2[7][2][n]<=h2_1_15;
endcase
case(addra2[7][n])
0:out2[7][3][n]<=h3_1_0;
1:out2[7][3][n]<=h3_1_1;
2:out2[7][3][n]<=h3_1_2;
3:out2[7][3][n]<=h3_1_3;
4:out2[7][3][n]<=h3_1_4;
5:out2[7][3][n]<=h3_1_5;
6:out2[7][3][n]<=h3_1_6;
7:out2[7][3][n]<=h3_1_7;
8:out2[7][3][n]<=h3_1_8;
9:out2[7][3][n]<=h3_1_9;
10:out2[7][3][n]<=h3_1_10;
11:out2[7][3][n]<=h3_1_11;
12:out2[7][3][n]<=h3_1_12;
13:out2[7][3][n]<=h3_1_13;
14:out2[7][3][n]<=h3_1_14;
15:out2[7][3][n]<=h3_1_15;
endcase
end
for(j=0;j<L;j=j+1)begin
sum[7][j][0]<=(out[7][j][0]>=0)?{15'b0,out[7][j][0][FILTER_WIDTH+1:0]}:{15'b111111111111111,out[7][j][0][FILTER_WIDTH+1:0]};
sum[7][j][1]<=(out[7][j][1]>=0)?{14'b0,out[7][j][1][FILTER_WIDTH+1:0],1'b0}:{14'b11111111111111,out[7][j][1][FILTER_WIDTH+1:0],1'b0};
sum[7][j][2]<=(out[7][j][2]>=0)?{13'b0,out[7][j][2][FILTER_WIDTH+1:0],2'b0}:{13'b1111111111111,out[7][j][2][FILTER_WIDTH+1:0],2'b0};
sum[7][j][3]<=(out[7][j][3]>=0)?{12'b0,out[7][j][3][FILTER_WIDTH+1:0],3'b0}:{12'b111111111111,out[7][j][3][FILTER_WIDTH+1:0],3'b0};
sum[7][j][4]<=(out[7][j][4]>=0)?{11'b0,out[7][j][4][FILTER_WIDTH+1:0],4'b0}:{11'b11111111111,out[7][j][4][FILTER_WIDTH+1:0],4'b0};
sum[7][j][5]<=(out[7][j][5]>=0)?{10'b0,out[7][j][5][FILTER_WIDTH+1:0],5'b0}:{10'b1111111111,out[7][j][5][FILTER_WIDTH+1:0],5'b0};
sum[7][j][6]<=(out[7][j][6]>=0)?{9'b0,out[7][j][6][FILTER_WIDTH+1:0],6'b0}:{9'b111111111,out[7][j][6][FILTER_WIDTH+1:0],6'b0};
sum[7][j][7]<=(out[7][j][7]>=0)?{8'b0,out[7][j][7][FILTER_WIDTH+1:0],7'b0}:{8'b11111111,out[7][j][7][FILTER_WIDTH+1:0],7'b0};
sum[7][j][8]<=(out[7][j][8]>=0)?{7'b0,out[7][j][8][FILTER_WIDTH+1:0],8'b0}:{7'b1111111,out[7][j][8][FILTER_WIDTH+1:0],8'b0};
sum[7][j][9]<=(out[7][j][9]>=0)?{6'b0,out[7][j][9][FILTER_WIDTH+1:0],9'b0}:{6'b111111,out[7][j][9][FILTER_WIDTH+1:0],9'b0};
sum[7][j][10]<=(out[7][j][10]>=0)?{5'b0,out[7][j][10][FILTER_WIDTH+1:0],10'b0}:{5'b11111,out[7][j][10][FILTER_WIDTH+1:0],10'b0};
sum[7][j][11]<=(out[7][j][11]>=0)?{4'b0,out[7][j][11][FILTER_WIDTH+1:0],11'b0}:{4'b1111,out[7][j][11][FILTER_WIDTH+1:0],11'b0};
sum[7][j][12]<=(out[7][j][12]>=0)?{3'b0,out[7][j][12][FILTER_WIDTH+1:0],12'b0}:{3'b111,out[7][j][12][FILTER_WIDTH+1:0],12'b0};
sum[7][j][13]<=(out[7][j][13]>=0)?{2'b0,out[7][j][13][FILTER_WIDTH+1:0],13'b0}:{2'b11,out[7][j][13][FILTER_WIDTH+1:0],13'b0};
sum[7][j][14]<=(out[7][j][14]>=0)?{1'b0,out[7][j][14][FILTER_WIDTH+1:0],14'b0}:{1'b1,out[7][j][14][FILTER_WIDTH+1:0],14'b0};
sum[7][j][15]<=-{out[7][j][15][FILTER_WIDTH+1:0],15'b0};
end
for(j=0;j<L;j=j+1)begin
sum1[7][j]<=sum[7][j][0]+sum[7][j][1]+sum[7][j][2]+sum[7][j][3]+sum[7][j][4]+sum[7][j][5]+sum[7][j][6]+sum[7][j][7]+sum[7][j][8]+sum[7][j][9]+sum[7][j][10]+sum[7][j][11]+sum[7][j][12]+sum[7][j][13]+sum[7][j][14]+sum[7][j][15];
end
end
end
always@(posedge clk1&en&l>=2)begin
if(!rst)begin
//移位8
cnt22<=cnt22+1;
if(l==2)begin
sum2[7]<={x,15'b0};
end
else begin
case(cnt22)
0:sum2[7]<=sum1[7][0];
1:sum2[7]<=sum1[7][1];
2:sum2[7]<=sum1[7][2];
3:sum2[7]<=sum1[7][3];
endcase
end
//滤波器9
for(k=0;k<TAP-1;k=k+1)begin
delay1[8][k+1]<=delay1[8][k];
end
delay1[8][0]<=(sum2[7]>=0)?sum2[7][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH-1]:{sum2[7][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH],1'b1};
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
addra2[8][n]<={delay1[8][7][n],delay1[8][6][n],delay1[8][5][n],delay1[8][4][n]};
addra1[8][n]<={delay1[8][3][n],delay1[8][2][n],delay1[8][1][n],delay1[8][0][n]};
end
for(j=0;j<L;j=j+1)begin
for(n=0;n<=INPUT_WIDTH;n=n+1)begin
out[8][j][n]<=out1[8][j][n]+out2[8][j][n];//前后相加
end
end
for(n=0;n<=INPUT_WIDTH;n=n+1)begin//查表
case(addra1[8][n])
0:out1[8][0][n]<=h0_0_0;
1:out1[8][0][n]<=h0_0_1;
2:out1[8][0][n]<=h0_0_2;
3:out1[8][0][n]<=h0_0_3;
4:out1[8][0][n]<=h0_0_4;
5:out1[8][0][n]<=h0_0_5;
6:out1[8][0][n]<=h0_0_6;
7:out1[8][0][n]<=h0_0_7;
8:out1[8][0][n]<=h0_0_8;
9:out1[8][0][n]<=h0_0_9;
10:out1[8][0][n]<=h0_0_10;
11:out1[8][0][n]<=h0_0_11;
12:out1[8][0][n]<=h0_0_12;
13:out1[8][0][n]<=h0_0_13;
14:out1[8][0][n]<=h0_0_14;
15:out1[8][0][n]<=h0_0_15;
endcase
case(addra1[8][n])
0:out1[8][1][n]<=h1_0_0;
1:out1[8][1][n]<=h1_0_1;
2:out1[8][1][n]<=h1_0_2;
3:out1[8][1][n]<=h1_0_3;
4:out1[8][1][n]<=h1_0_4;
5:out1[8][1][n]<=h1_0_5;
6:out1[8][1][n]<=h1_0_6;
7:out1[8][1][n]<=h1_0_7;
8:out1[8][1][n]<=h1_0_8;
9:out1[8][1][n]<=h1_0_9;
10:out1[8][1][n]<=h1_0_10;
11:out1[8][1][n]<=h1_0_11;
12:out1[8][1][n]<=h1_0_12;
13:out1[8][1][n]<=h1_0_13;
14:out1[8][1][n]<=h1_0_14;
15:out1[8][1][n]<=h1_0_15;
endcase
case(addra1[8][n])
0:out1[8][2][n]<=h2_0_0;
1:out1[8][2][n]<=h2_0_1;
2:out1[8][2][n]<=h2_0_2;
3:out1[8][2][n]<=h2_0_3;
4:out1[8][2][n]<=h2_0_4;
5:out1[8][2][n]<=h2_0_5;
6:out1[8][2][n]<=h2_0_6;
7:out1[8][2][n]<=h2_0_7;
8:out1[8][2][n]<=h2_0_8;
9:out1[8][2][n]<=h2_0_9;
10:out1[8][2][n]<=h2_0_10;
11:out1[8][2][n]<=h2_0_11;
12:out1[8][2][n]<=h2_0_12;
13:out1[8][2][n]<=h2_0_13;
14:out1[8][2][n]<=h2_0_14;
15:out1[8][2][n]<=h2_0_15;
endcase
case(addra1[8][n])
0:out1[8][3][n]<=h3_0_0;
1:out1[8][3][n]<=h3_0_1;
2:out1[8][3][n]<=h3_0_2;
3:out1[8][3][n]<=h3_0_3;
4:out1[8][3][n]<=h3_0_4;
5:out1[8][3][n]<=h3_0_5;
6:out1[8][3][n]<=h3_0_6;
7:out1[8][3][n]<=h3_0_7;
8:out1[8][3][n]<=h3_0_8;
9:out1[8][3][n]<=h3_0_9;
10:out1[8][3][n]<=h3_0_10;
11:out1[8][3][n]<=h3_0_11;
12:out1[8][3][n]<=h3_0_12;
13:out1[8][3][n]<=h3_0_13;
14:out1[8][3][n]<=h3_0_14;
15:out1[8][3][n]<=h3_0_15;
endcase
case(addra2[8][n])
0:out2[8][0][n]<=h0_1_0;
1:out2[8][0][n]<=h0_1_1;
2:out2[8][0][n]<=h0_1_2;
3:out2[8][0][n]<=h0_1_3;
4:out2[8][0][n]<=h0_1_4;
5:out2[8][0][n]<=h0_1_5;
6:out2[8][0][n]<=h0_1_6;
7:out2[8][0][n]<=h0_1_7;
8:out2[8][0][n]<=h0_1_8;
9:out2[8][0][n]<=h0_1_9;
10:out2[8][0][n]<=h0_1_10;
11:out2[8][0][n]<=h0_1_11;
12:out2[8][0][n]<=h0_1_12;
13:out2[8][0][n]<=h0_1_13;
14:out2[8][0][n]<=h0_1_14;
15:out2[8][0][n]<=h0_1_15;
endcase
case(addra2[8][n])
0:out2[8][1][n]<=h1_1_0;
1:out2[8][1][n]<=h1_1_1;
2:out2[8][1][n]<=h1_1_2;
3:out2[8][1][n]<=h1_1_3;
4:out2[8][1][n]<=h1_1_4;
5:out2[8][1][n]<=h1_1_5;
6:out2[8][1][n]<=h1_1_6;
7:out2[8][1][n]<=h1_1_7;
8:out2[8][1][n]<=h1_1_8;
9:out2[8][1][n]<=h1_1_9;
10:out2[8][1][n]<=h1_1_10;
11:out2[8][1][n]<=h1_1_11;
12:out2[8][1][n]<=h1_1_12;
13:out2[8][1][n]<=h1_1_13;
14:out2[8][1][n]<=h1_1_14;
15:out2[8][1][n]<=h1_1_15;
endcase
case(addra2[8][n])
0:out2[8][2][n]<=h2_1_0;
1:out2[8][2][n]<=h2_1_1;
2:out2[8][2][n]<=h2_1_2;
3:out2[8][2][n]<=h2_1_3;
4:out2[8][2][n]<=h2_1_4;
5:out2[8][2][n]<=h2_1_5;
6:out2[8][2][n]<=h2_1_6;
7:out2[8][2][n]<=h2_1_7;
8:out2[8][2][n]<=h2_1_8;
9:out2[8][2][n]<=h2_1_9;
10:out2[8][2][n]<=h2_1_10;
11:out2[8][2][n]<=h2_1_11;
12:out2[8][2][n]<=h2_1_12;
13:out2[8][2][n]<=h2_1_13;
14:out2[8][2][n]<=h2_1_14;
15:out2[8][2][n]<=h2_1_15;
endcase
case(addra2[8][n])
0:out2[8][3][n]<=h3_1_0;
1:out2[8][3][n]<=h3_1_1;
2:out2[8][3][n]<=h3_1_2;
3:out2[8][3][n]<=h3_1_3;
4:out2[8][3][n]<=h3_1_4;
5:out2[8][3][n]<=h3_1_5;
6:out2[8][3][n]<=h3_1_6;
7:out2[8][3][n]<=h3_1_7;
8:out2[8][3][n]<=h3_1_8;
9:out2[8][3][n]<=h3_1_9;
10:out2[8][3][n]<=h3_1_10;
11:out2[8][3][n]<=h3_1_11;
12:out2[8][3][n]<=h3_1_12;
13:out2[8][3][n]<=h3_1_13;
14:out2[8][3][n]<=h3_1_14;
15:out2[8][3][n]<=h3_1_15;
endcase
end
for(j=0;j<L;j=j+1)begin
sum[8][j][0]<=(out[8][j][0]>=0)?{15'b0,out[8][j][0][FILTER_WIDTH+1:0]}:{15'b111111111111111,out[8][j][0][FILTER_WIDTH+1:0]};
sum[8][j][1]<=(out[8][j][1]>=0)?{14'b0,out[8][j][1][FILTER_WIDTH+1:0],1'b0}:{14'b11111111111111,out[8][j][1][FILTER_WIDTH+1:0],1'b0};
sum[8][j][2]<=(out[8][j][2]>=0)?{13'b0,out[8][j][2][FILTER_WIDTH+1:0],2'b0}:{13'b1111111111111,out[8][j][2][FILTER_WIDTH+1:0],2'b0};
sum[8][j][3]<=(out[8][j][3]>=0)?{12'b0,out[8][j][3][FILTER_WIDTH+1:0],3'b0}:{12'b111111111111,out[8][j][3][FILTER_WIDTH+1:0],3'b0};
sum[8][j][4]<=(out[8][j][4]>=0)?{11'b0,out[8][j][4][FILTER_WIDTH+1:0],4'b0}:{11'b11111111111,out[8][j][4][FILTER_WIDTH+1:0],4'b0};
sum[8][j][5]<=(out[8][j][5]>=0)?{10'b0,out[8][j][5][FILTER_WIDTH+1:0],5'b0}:{10'b1111111111,out[8][j][5][FILTER_WIDTH+1:0],5'b0};
sum[8][j][6]<=(out[8][j][6]>=0)?{9'b0,out[8][j][6][FILTER_WIDTH+1:0],6'b0}:{9'b111111111,out[8][j][6][FILTER_WIDTH+1:0],6'b0};
sum[8][j][7]<=(out[8][j][7]>=0)?{8'b0,out[8][j][7][FILTER_WIDTH+1:0],7'b0}:{8'b11111111,out[8][j][7][FILTER_WIDTH+1:0],7'b0};
sum[8][j][8]<=(out[8][j][8]>=0)?{7'b0,out[8][j][8][FILTER_WIDTH+1:0],8'b0}:{7'b1111111,out[8][j][8][FILTER_WIDTH+1:0],8'b0};
sum[8][j][9]<=(out[8][j][9]>=0)?{6'b0,out[8][j][9][FILTER_WIDTH+1:0],9'b0}:{6'b111111,out[8][j][9][FILTER_WIDTH+1:0],9'b0};
sum[8][j][10]<=(out[8][j][10]>=0)?{5'b0,out[8][j][10][FILTER_WIDTH+1:0],10'b0}:{5'b11111,out[8][j][10][FILTER_WIDTH+1:0],10'b0};
sum[8][j][11]<=(out[8][j][11]>=0)?{4'b0,out[8][j][11][FILTER_WIDTH+1:0],11'b0}:{4'b1111,out[8][j][11][FILTER_WIDTH+1:0],11'b0};
sum[8][j][12]<=(out[8][j][12]>=0)?{3'b0,out[8][j][12][FILTER_WIDTH+1:0],12'b0}:{3'b111,out[8][j][12][FILTER_WIDTH+1:0],12'b0};
sum[8][j][13]<=(out[8][j][13]>=0)?{2'b0,out[8][j][13][FILTER_WIDTH+1:0],13'b0}:{2'b11,out[8][j][13][FILTER_WIDTH+1:0],13'b0};
sum[8][j][14]<=(out[8][j][14]>=0)?{1'b0,out[8][j][14][FILTER_WIDTH+1:0],14'b0}:{1'b1,out[8][j][14][FILTER_WIDTH+1:0],14'b0};
sum[8][j][15]<=-{out[8][j][15][FILTER_WIDTH+1:0],15'b0};
end
for(j=0;j<L;j=j+1)begin
sum1[8][j]<=sum[8][j][0]+sum[8][j][1]+sum[8][j][2]+sum[8][j][3]+sum[8][j][4]+sum[8][j][5]+sum[8][j][6]+sum[8][j][7]+sum[8][j][8]+sum[8][j][9]+sum[8][j][10]+sum[8][j][11]+sum[8][j][12]+sum[8][j][13]+sum[8][j][14]+sum[8][j][15];
end
end
end
always@(posedge clk&en&l>=1)begin
if(!rst)begin
//移位9
cnt11<=cnt11+1;
if(l==1)begin
sum2[8]<={x,15'b0};
end
else begin
case(cnt11)
0:sum2[8]<=sum1[8][0];
1:sum2[8]<=sum1[8][1];
2:sum2[8]<=sum1[8][2];
3:sum2[8]<=sum1[8][3];
endcase
end
end
end


always@(posedge clk&en)begin//选择输出
if(!rst)begin
y1<=(sum2[8]>=0)?sum2[8][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH-1]:{sum2[8][SUM_WIDTH-1:SUM_WIDTH-INPUT_WIDTH],1'b1};
end
else begin
y1<=0;
end
end
assign y11=y1;
endmodule